<% non_folder = %w(langmaterial physdesc accessrestrict userestrict) %>
<% folder = %w(abstract bioghist arrangement physloc custodhist odd acqinfo relatedmaterial separatedmaterial processinfo) %>
<div id="main-content" class="row">
  <div class="row" id="info_row">
    <div class="information col-sm-7">
      <%= render partial: 'shared/idbadge', locals: {:result => @result, :props => {} } %>
  </div>
  <div class="page_actions col-sm-5 right">
    <%= render partial: 'shared/page_actions', locals: {:title =>  strip_mixed_content(@result['json']['display_string'] || @result['title']), :url => request.fullpath } %>
  </div>
</div>
<div class="row">
    <%= render partial: 'shared/breadcrumbs' %>
</div>
<div class="row" id="tabs">
  <div class="col-sm-9 text-center tabbing navbar navbar-default">
    <ul class="tabbing nav nav-pills">
      <li><a class="active" href="#"><%= t('actions.collection_overview') %></a></li><li>
      <a  href="javascript:alert('this does what?');"><%= t('actions.hierarch') %></a></li><li>
<a href="javascript:alert('Is this for the container stuff?');"><%= t('actions.numeric') %></a></li>
    </ul>
  </div>
</div>
<div class="row" id="notes_row">
  <div class="col-sm-9">
    <% over = get_note(@result['json'], 'scopecontent') %>
    <% if over.blank?
       over = get_note(@result['json'], 'abstract') 
       folder.shift # remove abstract from in-folder notes
    end %>
    <%= render partial: 'shared/single_note', locals: {:type => 'abstract', :note_struct => over, :notitle => true} %>
    <% unless @result['json']['dates'].blank? %>
      <h4><%= t('resource._public.dates') %></h4>
      <% @result['json']['dates'].each do |date|  %>
       <span class="dates"><%= (!date['label'].blank? ? "#{date['label'].titlecase}: " : '') %><%= date['expression'] %></span>
      <% end %>
    <% end %>
    <% non_folder.each do |type| %>
       <%= render partial: 'shared/single_note', locals: {:type => type, :note_struct => get_note(@result['json'], type)}  %>
    <% end %>

    <% unless @result['json']['extents'].blank? %>
      <h4><%= t('resource._public.extent') %></h4>
       <% @result['json']['extents'].each do |ext| %> 
        <p class="extent"><%= ext['number'] %> <%= (ext['portion'].present? ? ext['portion'] : '') %> <%= ext['extent_type'] %></p>
      <% end %>
    <% end %>

    <div class="acc_holder" >
      <div class="panel-group" id="res_accordion">
	<% x = render partial: 'shared/multi_notes', locals: {:types => folder} %>
	<%= render partial: 'shared/accordion_panel', locals: {:p_title =>  t('resource._public.additional'), 
	      :p_id => 'add_desc', :p_body => x } %>
        <% unless @subjects.blank? %>
	   <% x= render partial: 'shared/present_list', locals: {:list => @subjects, :list_clss => 'subjects_list'} %>
	   <%= render partial: 'shared/accordion_panel', locals: {:p_title =>  t('subject._plural'),
	      :p_id => 'subj_list', :p_body => x} %>
	<% end %>
	<% unless @agents.blank? %>
	  <% x= render partial: 'shared/present_list', locals: {:list => @agents, :list_clss => 'agents_list'} %>
	   <%= render partial: 'shared/accordion_panel', locals: {:p_title =>  t('pui_agent.related'),
	     :p_id => 'agent_list', :p_body => x} %>
        <% end %>
	<% unless @finding_aid.blank? %>
	  <% x= render partial: 'resources/finding_aid' %>
	  <%= render partial: 'shared/accordion_panel', locals: {:p_title =>  t('resource._public.finding_aid.head'),
	     :p_id => 'fa', :p_body => x} %>
	<% end %>
	<% unless @repo_info.blank? || @repo_info['top']['name'].blank? %>
           <% x= render partial: 'repositories/repository_details' %>
	    <%= render partial: 'shared/accordion_panel', locals: {:p_title =>  t('repository.details'), 
	    :p_id => 'repo_deets', :p_body => x} %>
        <% end %>
      </div>        
    </div>
    <script type="text/javascript" >initialize_accordion(".note_panel", "<%= t('accordion.expand') %>" , "<%= t('accordion.collapse') %>");
    </script>
  </div>

  <div id="sidebar" class="col-sm-3 sidebar sidebar-container">
    <div class="search">
	<%= form_tag("#{@result['uri']}/search", method: 'get', :class=> "form-inline") do %>
	<div class="form-group">
	  <% label_tag(:q,  "#{t('actions.search')} #{t('resource._singular')}", :class => 'sr-only') %>
          <%= text_field_tag(:q, nil, :placeholder =>  "#{t('actions.search')} #{t('resource._singular')}", :class=> "form-control") %>
	</div>
	<div class="form-group">
	  <span class="inline-label"><%= t('search_results.filter.years') %>:</span>
	   <%= label_tag(:from_year, "#{t('search_results.filter.from_year')}", :class => 'sr-only') %>
	   <%= text_field_tag(:from_year, nil, :size => 4,:maxlength => 4, :placeholder => t('search_results.filter.from'),
            :class=>"form-control") %> <span class="inline-label"><%= t('to') %></span> <%= label_tag(:to_year, "#{t('search_results.filter.to_year')}", :class=> 'sr-only') %>
	   <%= text_field_tag(:to_year, nil, :size => 4, :maxlength => 4, :class=> "form-control",
           :placeholder => t('search_results.filter.to')) %>
	</div>
        <%= submit_tag(t('search-button.label'), :class=>'btn btn-primary btn-sm') %>
	<% end %>
    </div>

    <h4><%= t('cont_arr') %></h4>
    <%= render partial: 'shared/children_tree', locals: {:tree => @tree} %>
  </div>
</div>
