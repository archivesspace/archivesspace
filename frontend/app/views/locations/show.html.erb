<%= setup_context :object => @location, :title => @location.title %>

<div class="row">
   <div class="col-md-3">
     <%= render_aspace_partial :partial => "locations/sidebar" %>
   </div>
  <div class="col-md-9">
    <%= render_aspace_partial :partial => "toolbar" %>
    <div class="record-pane">
      <h2><%= @location.title %>  <span class="label label-info"><%= I18n.t("location._singular") %></span></h2>

      <%= render_aspace_partial :partial => "shared/flash_messages" %>

      <%= read_only_view(@location.to_hash) %>

      <%= display_audit_info(@location) %>

      <% if @location['location_profile'] %>
        <div class="form-horizontal">
          <div class="form-group token-list">
            <div class="control-label col-sm-2"><%= I18n.t("location_profile._singular") %></div>
            <div class="label-only col-sm-8">
              <%= render_token :object => @location["location_profile"]["_resolved"],
                               :label => @location["location_profile"]["_resolved"]["display_string"],
                               :type => "location_profile",
                               :uri => @location["location_profile"]["ref"] %>
            </div>
          </div>
        </div>
      <% end %>

      <% if @location['owner_repo'] %>
        <div class="form-horizontal">
          <div class="form-group token-list">
            <div class="control-label col-sm-2"><%= I18n.t("repository._singular") %></div>
            <div class="label-only col-sm-8">
              <%= render_token :object => @location["owner_repo"]["_resolved"],
               :label => @location["owner_repo"]["_resolved"]["display_string"],
               :type => "repository",
               :uri => @location["owner_repo"]["ref"] %>
            </div>
          </div>
        </div>
      <% end %>

      <% if @location.external_ids.length > 0 && show_external_ids? %>
        <%= render_aspace_partial :partial => "external_ids/show", :locals => { :external_ids => @location.external_ids, :section_id => "location_external_ids_" } %>
      <% end %>

      <% if @location.functions.length > 0 %>
        <%= render_aspace_partial :partial => "location_functions/show", :locals => { :functions => @location.functions, :section_id => "location_functions_" } %>
      <% end %>

      <%= render_aspace_partial :partial => "search/embedded", :locals => {
        :record => @location,
        :filter_term => {"location_uris" => @location.uri}.to_json,
        :heading_text => I18n.t("location._frontend.section.search_embedded"),
        :type => "top_container",
        :extra_columns => [
          {
            'title' => 'top_container._frontend.bulk_operations.collection_singular',
            'field' => 'collection_display_string_u_sstr',
            'formatter' => 'linked_records_listing',
            'sort_options' => {
              'sortable' => true,
              'sort_by' => 'collection_display_string_stored_u_ssort'
            }
          },
          {
            'title' => 'top_container.type',
            'field' => 'type_u_ssort',
            'formatter' => 'stringify',
            'sort_options' => {
              'sortable' => true,
              'sort_by' => 'type_u_ssort'
            }
          },
          {
            'title' => 'top_container.indicator',
            'field' => 'indicator_stored_u_ssort',
            'formatter' => 'stringify',
            'sort_options' => {
              'sortable' => true,
              'sort_by' => 'indicator_stored_u_ssort'
            }
          },
          {
            'title' => 'top_container.barcode',
            'field' => 'barcode_u_ssort',
            'formatter' => 'stringify',
            'sort_options' => {
              'sortable' => true,
              'sort_by' => 'barcode_u_ssort',
            }
          }
        ],
        :sort => 'title_sort asc'
      } %>

      <%= readonly_context :location, @location do |readonly| %>
        <%= show_plugins_for(@location, readonly) %>
      <% end %>
    </div>
  </div>
</div>
