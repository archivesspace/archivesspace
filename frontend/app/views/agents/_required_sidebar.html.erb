<%= render(:layout => '/shared/sidebar',
           :locals => {
             :record_type => 'agent',
             :record => @agent,
             :save_button_text => t("#{@agent.agent_type}._frontend.action.save")
           }) do |sidebar| %>

    <% unless @agent.agent_type.to_s == "agent_software" %>
      <%= sidebar.render_for_view_and_edit(
        :subrecord_type => 'record_control_information',
        :property => 'record_control_information',
        :anchor => "record_control_information",
        :sidebar_heading => true,
        :sidebar_children => [:agent_record_identifiers,
                            :agent_record_controls,
                            :agent_other_agency_codes,
                            :agent_conventions_declarations,
                            :metadata_rights_declarations,
                            :agent_maintenance_histories,
                            :agent_sources,
                            :agent_alternate_sets]) %>

      <%= sidebar.render_for_view_and_edit(:subrecord_type => 'agent_record_identifier', :property => 'agent_record_identifiers', :anchor => "#{@agent.agent_type}_agent_record_identifier", :lightmode_toggle => false, :subentry => true) %>
      <%= sidebar.render_for_view_and_edit(:subrecord_type => 'agent_record_control', :property => 'agent_record_controls', :anchor => "#{@agent.agent_type}_agent_record_control", :lightmode_toggle => true, :subentry => true) %>
      <%= sidebar.render_for_view_and_edit(:subrecord_type => 'agent_other_agency_code', :property => 'agent_other_agency_codes', :anchor => "#{@agent.agent_type}_agent_other_agency_codes", :lightmode_toggle => true, :subentry => true) %>
      <%= sidebar.render_for_view_and_edit(:subrecord_type => 'agent_conventions_declaration', :property => 'agent_conventions_declarations', :anchor => "#{@agent.agent_type}_agent_conventions_declaration", :lightmode_toggle => true, :subentry => true) %>
      <%= sidebar.render_for_view_and_edit(:subrecord_type => 'metadata_rights_declaration', :property => 'metadata_rights_declarations', :anchor => "#{@agent.agent_type}_metadata_rights_declaration", :lightmode_toggle => true, :subentry => true) %>
      <%= sidebar.render_for_view_and_edit(:subrecord_type => 'agent_maintenance_history', :property => 'agent_maintenance_histories', :anchor => "#{@agent.agent_type}_agent_maintenance_history", :lightmode_toggle => true, :subentry => true) %>
      <%= sidebar.render_for_view_and_edit(:subrecord_type => 'agent_source', :property => 'agent_sources', :anchor => "#{@agent.agent_type}_agent_sources", :lightmode_toggle => true, :subentry => true) %>
      <%= sidebar.render_for_view_and_edit(:subrecord_type => 'agent_alternate_set', :property => 'agent_alternate_sets', :anchor => "#{@agent.agent_type}_agent_alternate_set", :lightmode_toggle => true, :subentry => true) %>
    <% end %>

    <%= sidebar.render_for_view_and_edit(
      :subrecord_type => "identity_information",
      :property => "identity_information",
      :anchor => "identity_information",
      :sidebar_heading => true,
      :sidebar_children => [:agent_identifiers,
                          :names]) %>

    <%= sidebar.render_for_view_and_edit(:subrecord_type => 'agent_identifier', :property => 'agent_identifiers', :anchor => "#{@agent.agent_type}_agent_identifier", :lightmode_toggle => false, :subentry => true) %>

    <% name_type = @agent.agent_type.to_s.sub('agent', 'name') %>
    <%= sidebar.render_for_view_and_edit(:subrecord_type => 'agent_name', :property => 'names', :anchor => "#{@agent.agent_type}_names", :lightmode_toggle => false, :subentry => true) %>

    <%= sidebar.render_for_view_and_edit(
      :subrecord_type => "description_information",
      :property => "description_information",
      :anchor => "description_information",
      :sidebar_heading => true,
      :sidebar_children => [:dates_of_existence,
                          :agent_genders,
                          :agent_places,
                          :agent_occupations,
                          :agent_functions,
                          :agent_topics,
                          :used_languages,
                          :agent_contacts,
                          :external_documents]) %>

    <%= sidebar.render_for_view_and_edit(:subrecord_type => 'dates_of_existence', :property => 'dates_of_existence', :anchor => "#{@agent.agent_type}_dates_of_existence", :lightmode_toggle => false, :subentry => true) %>

    <% if @agent.agent_type.to_s == "agent_person" %>
      <%= sidebar.render_for_view_and_edit(:subrecord_type => 'agent_gender', :property => 'agent_genders', :anchor => "agent_person_agent_gender", :lightmode_toggle => true, :subentry => true) %>
    <% end %>

    <%= sidebar.render_for_view_and_edit(:subrecord_type => 'agent_place', :property => 'agent_places', :anchor => "#{@agent.agent_type}_agent_place", :lightmode_toggle => true, :subentry => true) %>
    <%= sidebar.render_for_view_and_edit(:subrecord_type => 'agent_occupation', :property => 'agent_occupations', :anchor => "#{@agent.agent_type}_agent_occupation", :lightmode_toggle => true, :subentry => true) %>
    <%= sidebar.render_for_view_and_edit(:subrecord_type => 'agent_function', :property => 'agent_functions', :anchor => "#{@agent.agent_type}_agent_function", :lightmode_toggle => true, :subentry => true) %>
    <%= sidebar.render_for_view_and_edit(:subrecord_type => 'agent_topic', :property => 'agent_topics', :anchor => "#{@agent.agent_type}_agent_topic", :lightmode_toggle => true, :subentry => true) %>
    <%= sidebar.render_for_view_and_edit(:subrecord_type => 'used_language', :property => 'used_languages', :anchor => "#{@agent.agent_type}_used_language", :lightmode_toggle => true, :subentry => true) %>

    <% if user_can?('view_agent_contact_record') %>
      <%= sidebar.render_for_view_and_edit(:subrecord_type => 'agent_contact', :property => 'agent_contacts', :anchor => "#{@agent.agent_type}_contact_details", :lightmode_toggle => false, :subentry => true) %>
    <% end %>

    <%= sidebar.render_for_view_and_edit(:subrecord_type => 'external_document', :property => "external_documents", :anchor => "#{@agent.agent_type}_external_documents", :lightmode_toggle => false, :subentry => true) %>

    <% unless @agent.agent_type.to_s == "agent_software" %>
      <%= sidebar.render_for_view_and_edit(
        :subrecord_type => "relation_information",
        :property => "relation_information",
        :anchor => "relation_information",
        :sidebar_heading => true,
        :sidebar_children => [:agent_resources]) %>

      <%= sidebar.render_for_view_and_edit(:subrecord_type => 'agent_resource', :property => 'agent_resources', :anchor => "#{@agent.agent_type}_agent_resource", :lightmode_toggle => true, :subentry => true) %>
    <% end %>

<% end %>
