<%= render(:layout => '/shared/sidebar',
           :locals => {
             :record_type => 'agent',
             :record => @agent,
             :plusone => :submit,
             :save_button_text => t("#{@agent.agent_type}._frontend.action.save")
           }) do |sidebar| %>

    <% unless @agent.agent_type.to_s == "agent_software" %>
      <%= sidebar.render_for_view_and_edit(
        :subrecord_type => 'record_control_information',
        :property => 'record_control_information',
        :anchor => "record_control_information",
        :sidebar_heading => true,
        :sidebar_children => [:agent_record_identifiers,
                              :agent_record_controls,
                              :agent_other_agency_codes,
                              :agent_conventions_declarations,
                              :metadata_rights_declarations,
                              :agent_maintenance_histories,
                              :agent_sources,
                              :agent_alternate_sets]) %>

        <%= sidebar.render_for_view_and_edit(
          :subrecord_type => 'agent_record_identifier',
          :property => 'agent_record_identifiers',
          :anchor => "#{@agent.agent_type}_agent_record_identifier",
          :subentry => true) %>

        <% if full_mode? || action_name == "show" %>
          <%= sidebar.render_for_view_and_edit(
          :subrecord_type => 'agent_record_control',
          :property => 'agent_record_controls',
          :anchor => "#{@agent.agent_type}_agent_record_control",
          :subentry => true,
          :lightmode_toggle => true) %>

          <%= sidebar.render_for_view_and_edit(
          :subrecord_type => 'agent_other_agency_code',
          :property => 'agent_other_agency_codes',
          :anchor => "#{@agent.agent_type}_agent_other_agency_codes",
          :subentry => true,
          :lightmode_toggle => true) %>

          <%= sidebar.render_for_view_and_edit(
          :subrecord_type => 'agent_conventions_declaration',
          :property => 'agent_conventions_declarations',
          :anchor => "#{@agent.agent_type}_agent_conventions_declaration",
          :subentry => true,
          :lightmode_toggle => true) %>

          <%= sidebar.render_for_view_and_edit(
          :subrecord_type => 'metadata_rights_declaration',
          :property => 'metadata_rights_declarations',
          :anchor => "#{@agent.agent_type}_metadata_rights_declaration",
          :subentry => true,
          :lightmode_toggle => true) %>

          <%= sidebar.render_for_view_and_edit(
          :subrecord_type => 'agent_maintenance_history',
          :property => 'agent_maintenance_histories',
          :anchor => "#{@agent.agent_type}_agent_maintenance_history",
          :subentry => true,
          :lightmode_toggle => true) %>

          <%= sidebar.render_for_view_and_edit(
          :subrecord_type => 'agent_source',
          :property => 'agent_sources',
          :anchor => "#{@agent.agent_type}_agent_sources",
          :subentry => true,
          :lightmode_toggle => true) %>

          <%= sidebar.render_for_view_and_edit(
          :subrecord_type => 'agent_alternate_set',
          :property => 'agent_alternate_sets',
          :anchor => "#{@agent.agent_type}_agent_alternate_set",
          :subentry => true,
          :lightmode_toggle => true) %>
        <% end %>
      <% end %>


    <%= sidebar.render_for_view_and_edit(
      :subrecord_type => "identity_information",
      :property => "identity_information",
      :anchor => "identity_information",
      :sidebar_heading => true,
      :sidebar_children => [:agent_identifiers,
                            :names]) %>

      <%= sidebar.render_for_view_and_edit(
        :subrecord_type => 'agent_identifier',
        :property => 'agent_identifiers',
        :anchor => "#{@agent.agent_type}_agent_identifier",
        :subentry => true) %>

      <%= sidebar.render_for_view_and_edit(
        :subrecord_type => 'agent_name',
        :property => 'names',
        :anchor => "#{@agent.agent_type}_names",
        :subentry => true) %>

    <%= sidebar.render_for_view_and_edit(
      :subrecord_type => "description_information",
      :property => "description_information",
      :anchor => "description_information",
      :sidebar_heading => true,
      :sidebar_children => [:dates_of_existence,
                            :agent_genders,
                            :agent_places,
                            :agent_occupations,
                            :agent_functions,
                            :agent_topics,
                            :used_languages,
                            :agent_contacts,
                            :notes,
                            :external_documents]) %>

      <%= sidebar.render_for_view_and_edit(
        :subrecord_type => 'dates_of_existence',
        :property => 'dates_of_existence',
        :anchor => "#{@agent.agent_type}_dates_of_existence",
        :subentry => true) %>

      <% if full_mode? || action_name == "show" %>

        <% if @agent.agent_type.to_s == "agent_person" %>
          <%= sidebar.render_for_view_and_edit(
          :subrecord_type => 'agent_gender',
          :property => 'agent_genders',
          :anchor => "agent_person_agent_gender",
          :subentry => true,
          :lightmode_toggle => true) %>
        <% end %>

        <%= sidebar.render_for_view_and_edit(
          :subrecord_type => 'agent_place',
          :property => 'agent_places',
          :anchor => "#{@agent.agent_type}_agent_place",
          :subentry => true,
          :lightmode_toggle => true) %>

        <%= sidebar.render_for_view_and_edit(
          :subrecord_type => 'agent_occupation',
          :property => 'agent_occupations',
          :anchor => "#{@agent.agent_type}_agent_occupation",
          :subentry => true,
          :lightmode_toggle => true) %>

        <%= sidebar.render_for_view_and_edit(
          :subrecord_type => 'agent_function',
          :property => 'agent_functions',
          :anchor => "#{@agent.agent_type}_agent_function",
          :subentry => true,
          :lightmode_toggle => true) %>

        <%= sidebar.render_for_view_and_edit(
          :subrecord_type => 'agent_topic',
          :property => 'agent_topics',
          :anchor => "#{@agent.agent_type}_agent_topic",
          :subentry => true,
          :lightmode_toggle => true) %>

        <%= sidebar.render_for_view_and_edit(
          :subrecord_type => 'used_language',
          :property => 'used_languages',
          :anchor => "#{@agent.agent_type}_used_language",
          :subentry => true,
          :lightmode_toggle => true) %>

      <% end %>

      <% if user_can?('view_agent_contact_record') %>
        <%= sidebar.render_for_view_and_edit(
          :subrecord_type => 'agent_contact',
          :property => 'agent_contacts',
          :anchor => "#{@agent.agent_type}_contact_details",
          :subentry => true) %>
      <% end %>

      <%= sidebar.render_for_view_and_edit(
        :subrecord_type => 'note',
        :property => 'notes',
        :anchor => "#{@agent.agent_type}_notes",
        :subentry => true) %>

      <%= sidebar.render_for_view_and_edit(
        :subrecord_type => 'external_document',
        :property => "external_documents",
        :anchor => "#{@agent.agent_type}_external_documents",
        :subentry => true) %>

    <% unless @agent.agent_type.to_s == "agent_software" %>
      <%= sidebar.render_for_view_and_edit(
        :subrecord_type => "relation_information",
        :property => "relation_information",
        :anchor => "relation_information",
        :sidebar_heading => true,
        :sidebar_children => [:agent_resources,
                              :related_agents]) %>

        <% if full_mode? || action_name == "show" %>
          <%= sidebar.render_for_view_and_edit(
            :subrecord_type => 'agent_resource',
            :property => 'agent_resources',
            :anchor => "#{@agent.agent_type}_agent_resource",
            :subentry => true,
            :lightmode_toggle => true) %>
        <% end %>

        <%= sidebar.render_for_view_and_edit(
          :subrecord_type => 'related_agent',
          :property => 'related_agents',
          :anchor => "related_agents",
          :subentry => true) %>

      <%= sidebar.render_for_view_only(
        :subrecord_type => 'search_embedded',
        :property => :none,
        :anchor => 'linked_agents') %>

      <%= sidebar.render_for_view_only(
        :title => t('agent._frontend.section.linked_via_rights_statement'),
        :subrecord_type => 'search_embedded',
        :property => :none,
        :anchor => 'linked_via_rights_statements') %>


      <%= sidebar.render_for_view_only(
        :title => t('agent._frontend.section.events'),
        :subrecord_type => 'event',
        :property => :none,
        :anchor => 'events') %>


      <% if @agent.agent_type.to_s == "agent_person" %>
        <%= sidebar.render_for_view_only(
          :title => t('assessment._frontend.linked_records.linked_via_assessment_surveyed_by'),
          :subrecord_type => 'assessment',
          :property => :none,
          :anchor => 'linked_assessments_surveyed_by') %>

        <%= sidebar.render_for_view_only(
          :title => t('assessment._frontend.linked_records.linked_via_assessment_reviewer'),
          :subrecord_type => 'assessment',
          :property => :none,
          :anchor => 'linked_assessments_reviewer') %>
      <% end %>
    <% end %>

<% end %>
