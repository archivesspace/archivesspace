<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: ArchivesSpaceService
  
    &mdash; Documentation by YARD 0.9.20
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "ArchivesSpaceService";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="alpha_index.html">Index (A)</a> &raquo;
    
    
    <span class="title">ArchivesSpaceService</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: ArchivesSpaceService
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Sinatra::Base</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Sinatra::Base</li>
          
            <li class="next">ArchivesSpaceService</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd><span class='object_link'><a href="AuthHelpers.html" title="AuthHelpers (module)">AuthHelpers</a></span>, <span class='object_link'><a href="ComponentTransfer/ResponseHelpers.html" title="ComponentTransfer::ResponseHelpers (module)">ComponentTransfer::ResponseHelpers</a></span>, <span class='object_link'><a href="CrudHelpers.html" title="CrudHelpers (module)">CrudHelpers</a></span>, <span class='object_link'><a href="Exceptions/ResponseMappings.html" title="Exceptions::ResponseMappings (module)">Exceptions::ResponseMappings</a></span>, <span class='object_link'><a href="ExportHelpers.html" title="ExportHelpers (module)">ExportHelpers</a></span>, <span class='object_link'><a href="RESTHelpers.html" title="RESTHelpers (module)">RESTHelpers</a></span>, <span class='object_link'><a href="RESTHelpers/ResponseHelpers.html" title="RESTHelpers::ResponseHelpers (module)">RESTHelpers::ResponseHelpers</a></span>, <span class='object_link'><a href="URIResolver.html" title="URIResolver (module)">URIResolver</a></span></dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>backend/app/controllers/bulk_import.rb<span class="defines">,<br />
  backend/app/main.rb,<br /> backend/app/controllers/job.rb,<br /> backend/app/controllers/oai.rb,<br /> backend/app/controllers/slug.rb,<br /> backend/app/controllers/term.rb,<br /> backend/app/controllers/event.rb,<br /> backend/app/controllers/group.rb,<br /> backend/app/controllers/users.rb,<br /> backend/app/controllers/schema.rb,<br /> backend/app/controllers/search.rb,<br /> backend/app/controllers/system.rb,<br /> backend/app/controllers/exports.rb,<br /> backend/app/controllers/reports.rb,<br /> backend/app/controllers/subject.rb,<br /> backend/app/controllers/version.rb,<br /> backend/app/controllers/ark_name.rb,<br /> backend/app/controllers/location.rb,<br /> backend/app/controllers/resource.rb,<br /> backend/app/controllers/accession.rb,<br /> backend/app/controllers/container.rb,<br /> backend/app/controllers/assessment.rb,<br /> backend/app/controllers/oai_config.rb,<br /> backend/app/controllers/permission.rb,<br /> backend/app/controllers/repository.rb,<br /> backend/app/controllers/vocabulary.rb,<br /> backend/app/controllers/enumeration.rb,<br /> backend/app/controllers/external_id.rb,<br /> backend/app/controllers/preferences.rb,<br /> backend/app/controllers/suppression.rb,<br /> backend/app/controllers/update_feed.rb,<br /> backend/app/controllers/agent_family.rb,<br /> backend/app/controllers/agent_person.rb,<br /> backend/app/controllers/batch_import.rb,<br /> backend/app/controllers/merge_request.rb,<br /> backend/app/controllers/notifications.rb,<br /> backend/app/controllers/rde_templates.rb,<br /> backend/app/controllers/agent_software.rb,<br /> backend/app/controllers/classification.rb,<br /> backend/app/controllers/default_values.rb,<br /> backend/app/controllers/delete_request.rb,<br /> backend/app/controllers/digital_object.rb,<br /> backend/app/controllers/update_monitor.rb,<br /> backend/app/controllers/archival_object.rb,<br /> backend/app/controllers/date_calculator.rb,<br /> backend/app/controllers/required_fields.rb,<br /> backend/app/controllers/location_profile.rb,<br /> backend/app/controllers/space_calculator.rb,<br /> backend/app/lib/bootstrap_access_control.rb,<br /> backend/app/controllers/container_profile.rb,<br /> backend/app/controllers/extent_calculator.rb,<br /> backend/app/controllers/component_transfer.rb,<br /> backend/app/controllers/classification_term.rb,<br /> backend/app/controllers/repository_transfer.rb,<br /> backend/app/controllers/id_lookup_controller.rb,<br /> backend/app/controllers/collection_management.rb,<br /> backend/app/controllers/agent_corporate_entity.rb,<br /> backend/app/controllers/component_add_children.rb,<br /> backend/app/controllers/custom_report_template.rb,<br /> backend/app/controllers/digital_object_component.rb,<br /> backend/app/controllers/assessment_attribute_definitions.rb</span>
</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>frozen_string_literal: true</p>


  </div>
</div>
<div class="tags">
  

</div>
<h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="ArchivesSpaceService/RequestWrappingMiddleware.html" title="ArchivesSpaceService::RequestWrappingMiddleware (class)">RequestWrappingMiddleware</a></span>
    
  
    
  
</p>

  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="BASE_SEARCH_PARAMS-constant" class="">BASE_SEARCH_PARAMS =
          
        </dt>
        <dd><pre class="code"><span class='lbrack token'>[</span><span class='lbrack token'>[</span><span class='string val'>&quot;q&quot;</span><span class='comma token'>,</span> <span class='rubyid_String constant id'>String</span><span class='comma token'>,</span> <span class='string val'>&quot;A search query string.  Uses Lucene 4.0 syntax: http://lucene.apache.org/core/4_0_0/queryparser/org/apache/lucene/queryparser/classic/package-summary.html  Search index structure can be found in solr/schema.xml&quot;</span><span class='comma token'>,</span>
    <span class='symbol val'>:optional</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_true true kw'>true</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
   <span class='lbrack token'>[</span><span class='string val'>&quot;aq&quot;</span><span class='comma token'>,</span> <span class='rubyid_JSONModel constant id'>JSONModel</span><span class='lparen token'>(</span><span class='symbol val'>:advanced_query</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='string val'>&quot;A json string containing the advanced query&quot;</span><span class='comma token'>,</span>
    <span class='symbol val'>:optional</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_true true kw'>true</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
   <span class='lbrack token'>[</span><span class='string val'>&quot;type&quot;</span><span class='comma token'>,</span>
    <span class='lbrack token'>[</span><span class='rubyid_String constant id'>String</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
    <span class='string val'>&quot;The record type to search (defaults to all types if not specified)&quot;</span><span class='comma token'>,</span>
    <span class='symbol val'>:optional</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_true true kw'>true</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
   <span class='lbrack token'>[</span><span class='string val'>&quot;sort&quot;</span><span class='comma token'>,</span>
    <span class='rubyid_String constant id'>String</span><span class='comma token'>,</span>
    <span class='string val'>&quot;The attribute to sort and the direction e.g. &amp;sort=title desc&amp;...&quot;</span><span class='comma token'>,</span>
    <span class='symbol val'>:optional</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_true true kw'>true</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
   <span class='lbrack token'>[</span><span class='string val'>&quot;facet&quot;</span><span class='comma token'>,</span>
    <span class='lbrack token'>[</span><span class='rubyid_String constant id'>String</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
    <span class='string val'>&quot;The list of the fields to produce facets for&quot;</span><span class='comma token'>,</span>
    <span class='symbol val'>:optional</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_true true kw'>true</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
   <span class='lbrack token'>[</span><span class='string val'>&quot;facet_mincount&quot;</span><span class='comma token'>,</span>
    <span class='rubyid_Integer constant id'>Integer</span><span class='comma token'>,</span>
    <span class='string val'>&quot;The minimum count for a facet field to be included in the response&quot;</span><span class='comma token'>,</span>
    <span class='symbol val'>:optional</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_true true kw'>true</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
   <span class='lbrack token'>[</span><span class='string val'>&quot;filter&quot;</span><span class='comma token'>,</span> <span class='rubyid_JSONModel constant id'>JSONModel</span><span class='lparen token'>(</span><span class='symbol val'>:advanced_query</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='string val'>&quot;A json string containing the advanced query to filter by&quot;</span><span class='comma token'>,</span>
    <span class='symbol val'>:optional</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_true true kw'>true</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
   <span class='lbrack token'>[</span><span class='string val'>&quot;exclude&quot;</span><span class='comma token'>,</span>
    <span class='lbrack token'>[</span><span class='rubyid_String constant id'>String</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
    <span class='string val'>&quot;A list of document IDs that should be excluded from results&quot;</span><span class='comma token'>,</span>
    <span class='symbol val'>:optional</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_true true kw'>true</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
    <span class='lbrack token'>[</span><span class='string val'>&quot;hl&quot;</span><span class='comma token'>,</span>
    <span class='rubyid_BooleanParam constant id'>BooleanParam</span><span class='comma token'>,</span>
    <span class='string val'>&quot;Whether to use highlighting&quot;</span><span class='comma token'>,</span>
    <span class='symbol val'>:optional</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_true true kw'>true</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
   <span class='lbrack token'>[</span><span class='string val'>&quot;root_record&quot;</span><span class='comma token'>,</span>
    <span class='rubyid_String constant id'>String</span><span class='comma token'>,</span>
    <span class='string val'>&quot;Search within a collection of records (defined by the record at the root of the tree)&quot;</span><span class='comma token'>,</span>
    <span class='symbol val'>:optional</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_true true kw'>true</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
  <span class='lbrack token'>[</span> <span class='string val'>&quot;dt&quot;</span><span class='comma token'>,</span>
      <span class='rubyid_String constant id'>String</span><span class='comma token'>,</span>
      <span class='string val'>&quot;Format to return (JSON default)&quot;</span><span class='comma token'>,</span>
      <span class='symbol val'>:optional</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_true true kw'>true</span> <span class='rbrack token'>]</span><span class='comma token'>,</span>
  <span class='lbrack token'>[</span><span class='string val'>&quot;fields&quot;</span><span class='comma token'>,</span>
      <span class='lbrack token'>[</span><span class='rubyid_String constant id'>String</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
      <span class='string val'>&quot;The list of fields to include in the results&quot;</span><span class='comma token'>,</span>
      <span class='symbol val'>:optional</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_true true kw'>true</span><span class='rbrack token'>]</span>
<span class='rbrack token'>]</span>
</pre></dd>
      
        <dt id="ALLOWED_PERMISSION_LEVELS-constant" class="">ALLOWED_PERMISSION_LEVELS =
          
        </dt>
        <dd><pre class="code"><span class='lbrack token'>[</span><span class='string val'>&quot;repository&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;global&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;all&quot;</span><span class='rbrack token'>]</span>
</pre></dd>
      
    </dl>
  



  
  
  <h3 class="inherited">Constants included
     from <span class='object_link'><a href="JSONModel.html" title="JSONModel (module)">JSONModel</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="JSONModel.html#REFERENCE_KEY_REGEX-constant" title="JSONModel::REFERENCE_KEY_REGEX (constant)">JSONModel::REFERENCE_KEY_REGEX</a></span></p>






  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_group-class_method" title="create_group (class method)">.<strong>create_group</strong>(group_code, description, users_to_add, permissions)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_hidden_system_user-class_method" title="create_hidden_system_user (class method)">.<strong>create_hidden_system_user</strong>(username, name, password)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_public_user-class_method" title="create_public_user (class method)">.<strong>create_public_user</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_search_user-class_method" title="create_search_user (class method)">.<strong>create_search_user</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_staff_user-class_method" title="create_staff_user (class method)">.<strong>create_staff_user</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_system_user-class_method" title="create_system_user (class method)">.<strong>create_system_user</strong>(username, name, password, hidden = false)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#loaded_hook-class_method" title="loaded_hook (class method)">.<strong>loaded_hook</strong>(&amp;block)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_up_base_permissions-class_method" title="set_up_base_permissions (class method)">.<strong>set_up_base_permissions</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#can_cancel_or_raise-instance_method" title="#can_cancel_or_raise (instance method)">#<strong>can_cancel_or_raise</strong>(job)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#can_create_or_raise-instance_method" title="#can_create_or_raise (instance method)">#<strong>can_create_or_raise</strong>(job)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#check_prefs_permissions-instance_method" title="#check_prefs_permissions (instance method)">#<strong>check_prefs_permissions</strong>(params)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#check_rde_permissions-instance_method" title="#check_rde_permissions (instance method)">#<strong>check_rde_permissions</strong>(params)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#current_user-instance_method" title="#current_user (instance method)">#<strong>current_user</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_entity_data-instance_method" title="#find_entity_data (instance method)">#<strong>find_entity_data</strong>(ark)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#has_permissions_or_raise-instance_method" title="#has_permissions_or_raise (instance method)">#<strong>has_permissions_or_raise</strong>(job, permissions)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Job runners can specify permissions required to create or cancel particular types of jobs, so we have special handling for it here.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#high_priority_request%3F-instance_method" title="#high_priority_request? (instance method)">#<strong>high_priority_request?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#resolve_references_for_space_calculator-instance_method" title="#resolve_references_for_space_calculator (instance method)">#<strong>resolve_references_for_space_calculator</strong>(space_calculator)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#session-instance_method" title="#session (instance method)">#<strong>session</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_oai_config-instance_method" title="#update_oai_config (instance method)">#<strong>update_oai_config</strong>(params)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="ComponentTransfer/ResponseHelpers.html" title="ComponentTransfer::ResponseHelpers (module)">ComponentTransfer::ResponseHelpers</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="ComponentTransfer/ResponseHelpers.html#component_transfer_response-instance_method" title="ComponentTransfer::ResponseHelpers#component_transfer_response (method)">#component_transfer_response</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="ExportHelpers.html" title="ExportHelpers (module)">ExportHelpers</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="ExportHelpers.html#generate_dc-instance_method" title="ExportHelpers#generate_dc (method)">#generate_dc</a></span>, <span class='object_link'><a href="ExportHelpers.html#generate_eac-instance_method" title="ExportHelpers#generate_eac (method)">#generate_eac</a></span>, <span class='object_link'><a href="ExportHelpers.html#generate_ead-instance_method" title="ExportHelpers#generate_ead (method)">#generate_ead</a></span>, <span class='object_link'><a href="ExportHelpers.html#generate_labels-instance_method" title="ExportHelpers#generate_labels (method)">#generate_labels</a></span>, <span class='object_link'><a href="ExportHelpers.html#generate_marc-instance_method" title="ExportHelpers#generate_marc (method)">#generate_marc</a></span>, <span class='object_link'><a href="ExportHelpers.html#generate_mets-instance_method" title="ExportHelpers#generate_mets (method)">#generate_mets</a></span>, <span class='object_link'><a href="ExportHelpers.html#generate_mods-instance_method" title="ExportHelpers#generate_mods (method)">#generate_mods</a></span>, <span class='object_link'><a href="ExportHelpers.html#generate_pdf_from_ead-instance_method" title="ExportHelpers#generate_pdf_from_ead (method)">#generate_pdf_from_ead</a></span>, <span class='object_link'><a href="ExportHelpers.html#pdf_response-instance_method" title="ExportHelpers#pdf_response (method)">#pdf_response</a></span>, <span class='object_link'><a href="ExportHelpers.html#safe_filename-instance_method" title="ExportHelpers#safe_filename (method)">#safe_filename</a></span>, <span class='object_link'><a href="ExportHelpers.html#stream_response-instance_method" title="ExportHelpers#stream_response (method)">#stream_response</a></span>, <span class='object_link'><a href="ExportHelpers.html#tsv_response-instance_method" title="ExportHelpers#tsv_response (method)">#tsv_response</a></span>, <span class='object_link'><a href="ExportHelpers.html#xml_response-instance_method" title="ExportHelpers#xml_response (method)">#xml_response</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="AuthHelpers.html" title="AuthHelpers (module)">AuthHelpers</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="AuthHelpers.html#create_session_for-instance_method" title="AuthHelpers#create_session_for (method)">#create_session_for</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Exceptions/ResponseMappings.html" title="Exceptions::ResponseMappings (module)">Exceptions::ResponseMappings</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Exceptions/ResponseMappings.html#included-class_method" title="Exceptions::ResponseMappings.included (method)">included</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="RESTHelpers/ResponseHelpers.html" title="RESTHelpers::ResponseHelpers (module)">RESTHelpers::ResponseHelpers</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="RESTHelpers/ResponseHelpers.html#created_response-instance_method" title="RESTHelpers::ResponseHelpers#created_response (method)">#created_response</a></span>, <span class='object_link'><a href="RESTHelpers/ResponseHelpers.html#deleted_response-instance_method" title="RESTHelpers::ResponseHelpers#deleted_response (method)">#deleted_response</a></span>, <span class='object_link'><a href="RESTHelpers/ResponseHelpers.html#json_response-instance_method" title="RESTHelpers::ResponseHelpers#json_response (method)">#json_response</a></span>, <span class='object_link'><a href="RESTHelpers/ResponseHelpers.html#modified_response-instance_method" title="RESTHelpers::ResponseHelpers#modified_response (method)">#modified_response</a></span>, <span class='object_link'><a href="RESTHelpers/ResponseHelpers.html#moved_response-instance_method" title="RESTHelpers::ResponseHelpers#moved_response (method)">#moved_response</a></span>, <span class='object_link'><a href="RESTHelpers/ResponseHelpers.html#suppressed_response-instance_method" title="RESTHelpers::ResponseHelpers#suppressed_response (method)">#suppressed_response</a></span>, <span class='object_link'><a href="RESTHelpers/ResponseHelpers.html#updated_response-instance_method" title="RESTHelpers::ResponseHelpers#updated_response (method)">#updated_response</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="CrudHelpers.html" title="CrudHelpers (module)">CrudHelpers</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="CrudHelpers.html#handle_create-instance_method" title="CrudHelpers#handle_create (method)">#handle_create</a></span>, <span class='object_link'><a href="CrudHelpers.html#handle_delete-instance_method" title="CrudHelpers#handle_delete (method)">#handle_delete</a></span>, <span class='object_link'><a href="CrudHelpers.html#handle_listing-instance_method" title="CrudHelpers#handle_listing (method)">#handle_listing</a></span>, <span class='object_link'><a href="CrudHelpers.html#handle_raw_listing-instance_method" title="CrudHelpers#handle_raw_listing (method)">#handle_raw_listing</a></span>, <span class='object_link'><a href="CrudHelpers.html#handle_unlimited_listing-instance_method" title="CrudHelpers#handle_unlimited_listing (method)">#handle_unlimited_listing</a></span>, <span class='object_link'><a href="CrudHelpers.html#handle_update-instance_method" title="CrudHelpers#handle_update (method)">#handle_update</a></span>, <span class='object_link'><a href="CrudHelpers.html#scoped_dataset-class_method" title="CrudHelpers.scoped_dataset (method)">scoped_dataset</a></span>, <span class='object_link'><a href="CrudHelpers.html#with_record_conflict_reporting-class_method" title="CrudHelpers.with_record_conflict_reporting (method)">with_record_conflict_reporting</a></span>, <span class='object_link'><a href="CrudHelpers.html#with_record_conflict_reporting-instance_method" title="CrudHelpers#with_record_conflict_reporting (method)">#with_record_conflict_reporting</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="RESTHelpers.html" title="RESTHelpers (module)">RESTHelpers</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="RESTHelpers.html#included-class_method" title="RESTHelpers.included (method)">included</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="JSONModel.html" title="JSONModel (module)">JSONModel</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="JSONModel.html#JSONModel-class_method" title="JSONModel.JSONModel (method)">JSONModel</a></span>, <span class='object_link'><a href="JSONModel.html#JSONModel-instance_method" title="JSONModel#JSONModel (method)">#JSONModel</a></span>, <span class='object_link'><a href="JSONModel.html#add_error_handler-class_method" title="JSONModel.add_error_handler (method)">add_error_handler</a></span>, <span class='object_link'><a href="JSONModel.html#all-class_method" title="JSONModel.all (method)">all</a></span>, <span class='object_link'><a href="JSONModel.html#allow_unmapped_enum_value-class_method" title="JSONModel.allow_unmapped_enum_value (method)">allow_unmapped_enum_value</a></span>, <span class='object_link'><a href="JSONModel.html#backend_url-class_method" title="JSONModel.backend_url (method)">backend_url</a></span>, <span class='object_link'><a href="JSONModel.html#check_valid_refs-class_method" title="JSONModel.check_valid_refs (method)">check_valid_refs</a></span>, <span class='object_link'><a href="JSONModel.html#client_mode%3F-class_method" title="JSONModel.client_mode? (method)">client_mode?</a></span>, <span class='object_link'><a href="JSONModel.html#custom_validations-class_method" title="JSONModel.custom_validations (method)">custom_validations</a></span>, <span class='object_link'><a href="JSONModel.html#destroy_model-class_method" title="JSONModel.destroy_model (method)">destroy_model</a></span>, <span class='object_link'><a href="JSONModel.html#enum_default_value-class_method" title="JSONModel.enum_default_value (method)">enum_default_value</a></span>, <span class='object_link'><a href="JSONModel.html#enum_values-class_method" title="JSONModel.enum_values (method)">enum_values</a></span>, <span class='object_link'><a href="JSONModel.html#handle_error-class_method" title="JSONModel.handle_error (method)">handle_error</a></span>, <span class='object_link'><a href="JSONModel.html#init-class_method" title="JSONModel.init (method)">init</a></span>, <span class='object_link'><a href="JSONModel.html#load_schema-class_method" title="JSONModel.load_schema (method)">load_schema</a></span>, <span class='object_link'><a href="JSONModel.html#models-instance_method" title="JSONModel#models (method)">#models</a></span>, <span class='object_link'><a href="JSONModel.html#models-class_method" title="JSONModel.models (method)">models</a></span>, <span class='object_link'><a href="JSONModel.html#parse_jsonmodel_ref-class_method" title="JSONModel.parse_jsonmodel_ref (method)">parse_jsonmodel_ref</a></span>, <span class='object_link'><a href="JSONModel.html#parse_reference-class_method" title="JSONModel.parse_reference (method)">parse_reference</a></span>, <span class='object_link'><a href="JSONModel.html#repository-class_method" title="JSONModel.repository (method)">repository</a></span>, <span class='object_link'><a href="JSONModel.html#repository_for-class_method" title="JSONModel.repository_for (method)">repository_for</a></span>, <span class='object_link'><a href="JSONModel.html#schema_src-class_method" title="JSONModel.schema_src (method)">schema_src</a></span>, <span class='object_link'><a href="JSONModel.html#set_publish_flags!-class_method" title="JSONModel.set_publish_flags! (method)">set_publish_flags!</a></span>, <span class='object_link'><a href="JSONModel.html#set_repository-class_method" title="JSONModel.set_repository (method)">set_repository</a></span>, <span class='object_link'><a href="JSONModel.html#strict_mode-class_method" title="JSONModel.strict_mode (method)">strict_mode</a></span>, <span class='object_link'><a href="JSONModel.html#strict_mode%3F-class_method" title="JSONModel.strict_mode? (method)">strict_mode?</a></span>, <span class='object_link'><a href="JSONModel.html#validate_schema-class_method" title="JSONModel.validate_schema (method)">validate_schema</a></span>, <span class='object_link'><a href="JSONModel.html#with_repository-class_method" title="JSONModel.with_repository (method)">with_repository</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="URIResolver.html" title="URIResolver (module)">URIResolver</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="URIResolver.html#ensure_reference_is_valid-class_method" title="URIResolver.ensure_reference_is_valid (method)">ensure_reference_is_valid</a></span>, <span class='object_link'><a href="URIResolver.html#register_resolver-class_method" title="URIResolver.register_resolver (method)">register_resolver</a></span>, <span class='object_link'><a href="URIResolver.html#resolve_references-class_method" title="URIResolver.resolve_references (method)">resolve_references</a></span></p>

  

  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="create_group-class_method">
  
    .<strong>create_group</strong>(group_code, description, users_to_add, permissions)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'backend/app/lib/bootstrap_access_control.rb', line 25</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_create_group identifier id'>create_group</span><span class='lparen token'>(</span><span class='rubyid_group_code identifier id'>group_code</span><span class='comma token'>,</span> <span class='rubyid_description identifier id'>description</span><span class='comma token'>,</span> <span class='rubyid_users_to_add identifier id'>users_to_add</span><span class='comma token'>,</span> <span class='rubyid_permissions identifier id'>permissions</span><span class='rparen token'>)</span>
  <span class='rubyid_global_repo identifier id'>global_repo</span> <span class='assign token'>=</span> <span class='rubyid_Repository constant id'>Repository</span><span class='lbrack token'>[</span><span class='symbol val'>:repo_code</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_Repository constant id'>Repository</span><span class='dot token'>.</span><span class='rubyid_GLOBAL constant id'>GLOBAL</span><span class='rbrack token'>]</span>

  <span class='rubyid_RequestContext constant id'>RequestContext</span><span class='dot token'>.</span><span class='rubyid_open identifier id'>open</span><span class='lparen token'>(</span><span class='symbol val'>:repo_id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_global_repo identifier id'>global_repo</span><span class='dot token'>.</span><span class='rubyid_id identifier id'>id</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span>
    <span class='rubyid_if if kw'>if</span> <span class='rubyid_Group constant id'>Group</span><span class='lbrack token'>[</span><span class='symbol val'>:group_code</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_group_code identifier id'>group_code</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
      <span class='rubyid_created_group identifier id'>created_group</span> <span class='assign token'>=</span> <span class='rubyid_Group constant id'>Group</span><span class='dot token'>.</span><span class='rubyid_create_from_json identifier id'>create_from_json</span><span class='lparen token'>(</span><span class='rubyid_JSONModel constant id'>JSONModel</span><span class='lparen token'>(</span><span class='symbol val'>:group</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_from_hash identifier id'>from_hash</span><span class='lparen token'>(</span><span class='symbol val'>:group_code</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_group_code identifier id'>group_code</span><span class='comma token'>,</span>
                                                                         <span class='symbol val'>:description</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_description identifier id'>description</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                             <span class='symbol val'>:is_system_user</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>1</span><span class='rparen token'>)</span>
      <span class='rubyid_users_to_add identifier id'>users_to_add</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_user identifier id'>user</span><span class='bitor op'>|</span>
        <span class='rubyid_created_group identifier id'>created_group</span><span class='dot token'>.</span><span class='rubyid_add_user identifier id'>add_user</span><span class='lparen token'>(</span><span class='rubyid_User constant id'>User</span><span class='lbrack token'>[</span><span class='symbol val'>:username</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_user identifier id'>user</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
      <span class='rubyid_end end kw'>end</span>

      <span class='rubyid_permissions identifier id'>permissions</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_permission identifier id'>permission</span><span class='bitor op'>|</span>
        <span class='rubyid_created_group identifier id'>created_group</span><span class='dot token'>.</span><span class='rubyid_grant identifier id'>grant</span><span class='lparen token'>(</span><span class='rubyid_permission identifier id'>permission</span><span class='rparen token'>)</span>
      <span class='rubyid_end end kw'>end</span>

      <span class='rubyid_return return kw'>return</span> <span class='rubyid_true true kw'>true</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_false false kw'>false</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_hidden_system_user-class_method">
  
    .<strong>create_hidden_system_user</strong>(username, name, password)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


20
21
22</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'backend/app/lib/bootstrap_access_control.rb', line 20</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_create_hidden_system_user identifier id'>create_hidden_system_user</span><span class='lparen token'>(</span><span class='rubyid_username identifier id'>username</span><span class='comma token'>,</span> <span class='rubyid_name identifier id'>name</span><span class='comma token'>,</span> <span class='rubyid_password identifier id'>password</span><span class='rparen token'>)</span>
  <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_create_system_user identifier id'>create_system_user</span><span class='lparen token'>(</span><span class='rubyid_username identifier id'>username</span><span class='comma token'>,</span> <span class='rubyid_name identifier id'>name</span><span class='comma token'>,</span> <span class='rubyid_password identifier id'>password</span><span class='comma token'>,</span> <span class='rubyid_true true kw'>true</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_public_user-class_method">
  
    .<strong>create_public_user</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


313
314
315
316
317
318</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'backend/app/lib/bootstrap_access_control.rb', line 313</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_create_public_user identifier id'>create_public_user</span>
  <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_create_hidden_system_user identifier id'>create_hidden_system_user</span><span class='lparen token'>(</span><span class='rubyid_User constant id'>User</span><span class='dot token'>.</span><span class='rubyid_PUBLIC_USERNAME constant id'>PUBLIC_USERNAME</span><span class='comma token'>,</span> <span class='string val'>&quot;Public Interface Anonymous&quot;</span><span class='comma token'>,</span> <span class='rubyid_AppConfig constant id'>AppConfig</span><span class='lbrack token'>[</span><span class='symbol val'>:search_user_secret</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='rubyid_DBAuth constant id'>DBAuth</span><span class='dot token'>.</span><span class='rubyid_set_password identifier id'>set_password</span><span class='lparen token'>(</span><span class='rubyid_User constant id'>User</span><span class='dot token'>.</span><span class='rubyid_PUBLIC_USERNAME constant id'>PUBLIC_USERNAME</span><span class='comma token'>,</span> <span class='rubyid_AppConfig constant id'>AppConfig</span><span class='lbrack token'>[</span><span class='symbol val'>:public_user_secret</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_create_group identifier id'>create_group</span><span class='lparen token'>(</span><span class='rubyid_Group constant id'>Group</span><span class='dot token'>.</span><span class='rubyid_PUBLIC_GROUP_CODE constant id'>PUBLIC_GROUP_CODE</span><span class='comma token'>,</span> <span class='string val'>&quot;Public Anonymous&quot;</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='rubyid_User constant id'>User</span><span class='dot token'>.</span><span class='rubyid_PUBLIC_USERNAME constant id'>PUBLIC_USERNAME</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                    <span class='lbrack token'>[</span><span class='string val'>&quot;view_repository&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;view_all_records&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_search_user-class_method">
  
    .<strong>create_search_user</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


305
306
307
308
309
310</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'backend/app/lib/bootstrap_access_control.rb', line 305</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_create_search_user identifier id'>create_search_user</span>
  <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_create_hidden_system_user identifier id'>create_hidden_system_user</span><span class='lparen token'>(</span><span class='rubyid_User constant id'>User</span><span class='dot token'>.</span><span class='rubyid_SEARCH_USERNAME constant id'>SEARCH_USERNAME</span><span class='comma token'>,</span> <span class='string val'>&quot;Search Indexer&quot;</span><span class='comma token'>,</span> <span class='rubyid_AppConfig constant id'>AppConfig</span><span class='lbrack token'>[</span><span class='symbol val'>:search_user_secret</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='rubyid_DBAuth constant id'>DBAuth</span><span class='dot token'>.</span><span class='rubyid_set_password identifier id'>set_password</span><span class='lparen token'>(</span><span class='rubyid_User constant id'>User</span><span class='dot token'>.</span><span class='rubyid_SEARCH_USERNAME constant id'>SEARCH_USERNAME</span><span class='comma token'>,</span> <span class='rubyid_AppConfig constant id'>AppConfig</span><span class='lbrack token'>[</span><span class='symbol val'>:search_user_secret</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_create_group identifier id'>create_group</span><span class='lparen token'>(</span><span class='rubyid_Group constant id'>Group</span><span class='dot token'>.</span><span class='rubyid_SEARCHINDEX_GROUP_CODE constant id'>SEARCHINDEX_GROUP_CODE</span><span class='comma token'>,</span> <span class='string val'>&quot;Search index&quot;</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='rubyid_User constant id'>User</span><span class='dot token'>.</span><span class='rubyid_SEARCH_USERNAME constant id'>SEARCH_USERNAME</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                    <span class='lbrack token'>[</span><span class='string val'>&quot;view_repository&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;view_suppressed&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;view_all_records&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;index_system&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_staff_user-class_method">
  
    .<strong>create_staff_user</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


321
322
323
324
325
326</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'backend/app/lib/bootstrap_access_control.rb', line 321</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_create_staff_user identifier id'>create_staff_user</span>
  <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_create_hidden_system_user identifier id'>create_hidden_system_user</span><span class='lparen token'>(</span><span class='rubyid_User constant id'>User</span><span class='dot token'>.</span><span class='rubyid_STAFF_USERNAME constant id'>STAFF_USERNAME</span><span class='comma token'>,</span> <span class='string val'>&quot;Staff System User&quot;</span><span class='comma token'>,</span> <span class='rubyid_AppConfig constant id'>AppConfig</span><span class='lbrack token'>[</span><span class='symbol val'>:search_user_secret</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='rubyid_DBAuth constant id'>DBAuth</span><span class='dot token'>.</span><span class='rubyid_set_password identifier id'>set_password</span><span class='lparen token'>(</span><span class='rubyid_User constant id'>User</span><span class='dot token'>.</span><span class='rubyid_STAFF_USERNAME constant id'>STAFF_USERNAME</span><span class='comma token'>,</span> <span class='rubyid_AppConfig constant id'>AppConfig</span><span class='lbrack token'>[</span><span class='symbol val'>:staff_user_secret</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_create_group identifier id'>create_group</span><span class='lparen token'>(</span><span class='rubyid_Group constant id'>Group</span><span class='dot token'>.</span><span class='rubyid_STAFF_GROUP_CODE constant id'>STAFF_GROUP_CODE</span><span class='comma token'>,</span> <span class='string val'>&quot;Staff System Group&quot;</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='rubyid_User constant id'>User</span><span class='dot token'>.</span><span class='rubyid_STAFF_USERNAME constant id'>STAFF_USERNAME</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                    <span class='lbrack token'>[</span><span class='string val'>&quot;mediate_edits&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_system_user-class_method">
  
    .<strong>create_system_user</strong>(username, name, password, hidden = false)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


3
4
5
6
7
8
9
10
11
12
13
14
15
16
17</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'backend/app/lib/bootstrap_access_control.rb', line 3</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_create_system_user identifier id'>create_system_user</span><span class='lparen token'>(</span><span class='rubyid_username identifier id'>username</span><span class='comma token'>,</span> <span class='rubyid_name identifier id'>name</span><span class='comma token'>,</span> <span class='rubyid_password identifier id'>password</span><span class='comma token'>,</span> <span class='rubyid_hidden identifier id'>hidden</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span><span class='rparen token'>)</span>
  <span class='rubyid_if if kw'>if</span> <span class='rubyid_User constant id'>User</span><span class='lbrack token'>[</span><span class='symbol val'>:username</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_username identifier id'>username</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
    <span class='rubyid_User constant id'>User</span><span class='dot token'>.</span><span class='rubyid_create_from_json identifier id'>create_from_json</span><span class='lparen token'>(</span><span class='rubyid_JSONModel constant id'>JSONModel</span><span class='lparen token'>(</span><span class='symbol val'>:user</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_from_hash identifier id'>from_hash</span><span class='lparen token'>(</span><span class='symbol val'>:username</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_username identifier id'>username</span><span class='comma token'>,</span>
                                                     <span class='symbol val'>:name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_name identifier id'>name</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                          <span class='lbrace token'>{</span>
                            <span class='symbol val'>:source</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;local&quot;</span><span class='comma token'>,</span>
                            <span class='symbol val'>:is_system_user</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>1</span>
                          <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='rubyid_merge identifier id'>merge</span><span class='lparen token'>(</span><span class='rubyid_hidden identifier id'>hidden</span> <span class='integer val'>? </span><span class='lbrace token'>{</span><span class='symbol val'>:is_hidden_user</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>1</span><span class='rbrace token'>}</span> <span class='colon op'>:</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='rubyid_DBAuth constant id'>DBAuth</span><span class='dot token'>.</span><span class='rubyid_set_password identifier id'>set_password</span><span class='lparen token'>(</span><span class='rubyid_username identifier id'>username</span><span class='comma token'>,</span> <span class='rubyid_password identifier id'>password</span><span class='rparen token'>)</span>

    <span class='rubyid_return return kw'>return</span> <span class='rubyid_true true kw'>true</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_false false kw'>false</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="loaded_hook-class_method">
  
    .<strong>loaded_hook</strong>(&amp;block)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


52
53
54
55
56
57
58</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'backend/app/main.rb', line 52</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_loaded_hook identifier id'>loaded_hook</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='rubyid_if if kw'>if</span> <span class='rubyid_@archivesspace_loaded ivar id'>@archivesspace_loaded</span>
    <span class='rubyid_block identifier id'>block</span><span class='dot token'>.</span><span class='rubyid_call identifier id'>call</span>
  <span class='rubyid_else else kw'>else</span>
    <span class='rubyid_@loaded_hooks ivar id'>@loaded_hooks</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_block identifier id'>block</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_up_base_permissions-class_method">
  
    .<strong>set_up_base_permissions</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'backend/app/lib/bootstrap_access_control.rb', line 49</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_set_up_base_permissions identifier id'>set_up_base_permissions</span>

  <span class='rubyid_if if kw'>if</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_Repository constant id'>Repository</span><span class='lbrack token'>[</span><span class='symbol val'>:repo_code</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_Repository constant id'>Repository</span><span class='dot token'>.</span><span class='rubyid_GLOBAL constant id'>GLOBAL</span><span class='rbrack token'>]</span>
    <span class='rubyid_Repository constant id'>Repository</span><span class='dot token'>.</span><span class='rubyid_create identifier id'>create</span><span class='lparen token'>(</span><span class='symbol val'>:repo_code</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_Repository constant id'>Repository</span><span class='dot token'>.</span><span class='rubyid_GLOBAL constant id'>GLOBAL</span><span class='comma token'>,</span>
                      <span class='symbol val'>:name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Global repository&quot;</span><span class='comma token'>,</span>
                      <span class='symbol val'>:json_schema_version</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_JSONModel constant id'>JSONModel</span><span class='lparen token'>(</span><span class='symbol val'>:repository</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_schema_version identifier id'>schema_version</span><span class='comma token'>,</span>
                      <span class='symbol val'>:hidden</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>1</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_AgentSoftware constant id'>AgentSoftware</span><span class='dot token'>.</span><span class='rubyid_ensure_correctly_versioned_archivesspace_record identifier id'>ensure_correctly_versioned_archivesspace_record</span>


  <span class='comment val'># Create the admin user</span>
  <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_create_system_user identifier id'>create_system_user</span><span class='lparen token'>(</span><span class='rubyid_User constant id'>User</span><span class='dot token'>.</span><span class='rubyid_ADMIN_USERNAME constant id'>ADMIN_USERNAME</span><span class='comma token'>,</span> <span class='string val'>&quot;Administrator&quot;</span><span class='comma token'>,</span> <span class='rubyid_AppConfig constant id'>AppConfig</span><span class='lbrack token'>[</span><span class='symbol val'>:default_admin_password</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_create_group identifier id'>create_group</span><span class='lparen token'>(</span><span class='rubyid_Group constant id'>Group</span><span class='dot token'>.</span><span class='rubyid_ADMIN_GROUP_CODE constant id'>ADMIN_GROUP_CODE</span><span class='comma token'>,</span> <span class='string val'>&quot;Administrators&quot;</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='rubyid_User constant id'>User</span><span class='dot token'>.</span><span class='rubyid_ADMIN_USERNAME constant id'>ADMIN_USERNAME</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>


  <span class='comment val'>## Standard permissions</span>
  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;administer_system&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to act as a system administrator&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;global&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;manage_users&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to manage user accounts while logged in&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;global&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;become_user&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to masquerade as another user&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;global&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;view_all_records&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to view any record in the system&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;global&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:system</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_true true kw'>true</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;create_repository&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to create new repositories&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;global&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;delete_repository&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to delete a repository&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;global&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;transfer_repository&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to transfer the contents of a repository&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;index_system&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to read any record for indexing&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;global&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:system</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_true true kw'>true</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;manage_repository&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to manage a given repository&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;update_accession_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to create and modify accessions records&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;update_resource_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to create and modify resources records&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;update_digital_object_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to create and modify digital objects records&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;update_event_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to create and modify event records&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;delete_event_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to delete event records&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;suppress_archival_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to suppress the major archival record types: accessions/resources/digital objects/components/collection management/events&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;transfer_archival_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to transfer records between different repositories&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;delete_archival_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to delete the major archival record types: accessions/resources/digital objects/components/collection management/events&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;view_suppressed&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to view suppressed records in a given repository&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;view_repository&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to view a given repository&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;update_classification_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to create and modify classification records&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;delete_classification_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to delete classification records&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;mediate_edits&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;Track concurrent updates to records&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;global&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:system</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_true true kw'>true</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;import_records&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to initiate an importer job&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;cancel_importer_job&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to cancel a queued or running importer job&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;create_job&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to create background jobs&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;cancel_job&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to cancel background jobs&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>


  <span class='comment val'># Updates and deletes to locations, subjects, agents, and enumerations are a bit funny: they&#39;re</span>
  <span class='comment val'># global objects, but users are granted permission to modify them by being</span>
  <span class='comment val'># associated with a group within a repository.</span>
  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;manage_subject_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to create, modify and delete a subject record&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;update_subject_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to create and modify subject records&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:implied_by</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&#39;manage_subject_record&#39;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;global&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;manage_agent_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to create, modify and delete an agent record&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;update_agent_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to create and modify agent records&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:implied_by</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&#39;manage_agent_record&#39;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;global&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;view_agent_contact_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to view contact details for agent records&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;manage_vocabulary_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to create, modify and delete a vocabulary record&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;update_vocabulary_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to create and modify vocabulary records&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:implied_by</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&#39;manage_vocabulary_record&#39;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;global&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;update_location_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to create and modify location records&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:implied_by</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&#39;manage_repository&#39;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;global&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;delete_agent_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to delete agent records&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:implied_by</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&#39;manage_agent_record&#39;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;global&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;delete_subject_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to delete subject records&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:implied_by</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&#39;manage_subject_record&#39;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;global&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;delete_vocabulary_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to delete vocabulary records&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:implied_by</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&#39;delete_archival_record&#39;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;global&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;manage_enumeration_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to create, modify and delete a controlled vocabulary list record&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;update_enumeration_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to manage controlled vocabulary lists&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:implied_by</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&#39;manage_enumeration_record&#39;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;global&quot;</span><span class='rparen token'>)</span>


  <span class='comment val'># Merge permissions are special too.  A user with merge_agents_and_subjects</span>
  <span class='comment val'># in any repository is granted merge_agent_record and merge_subject_record</span>
  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;merge_agents_and_subjects&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to merge agent/subject records&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>


  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;merge_subject_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to merge subject records&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:implied_by</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&#39;merge_agents_and_subjects&#39;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;global&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;merge_agent_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to merge agent records&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:implied_by</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&#39;merge_agents_and_subjects&#39;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;global&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;merge_archival_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to merge archival records records&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>


  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;manage_rde_templates&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to create and delete RDE templates&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;update_container_record&quot;</span><span class='comma token'>,</span>
                <span class='string val'>&quot;The ability to create and update container records&quot;</span><span class='comma token'>,</span>
                <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;manage_container_record&quot;</span><span class='comma token'>,</span>
                <span class='string val'>&quot;The ability to delete and bulk update container records&quot;</span><span class='comma token'>,</span>
                <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;manage_container_profile_record&quot;</span><span class='comma token'>,</span>
                <span class='string val'>&quot;The ability to create, modify and delete a container profile record&quot;</span><span class='comma token'>,</span>
                <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;update_container_profile_record&quot;</span><span class='comma token'>,</span>
                <span class='string val'>&quot;The ability to create/update/delete container profile records&quot;</span><span class='comma token'>,</span>
                <span class='symbol val'>:implied_by</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&#39;manage_container_profile_record&#39;</span><span class='comma token'>,</span>
                <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;global&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;manage_location_profile_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to create, modify and delete a location profile record&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;update_location_profile_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to create/update/delete location profile records&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:implied_by</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&#39;manage_location_profile_record&#39;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;global&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;update_assessment_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to create and modify assessment records&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;delete_assessment_record&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to delete assessment records&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_Permission constant id'>Permission</span><span class='dot token'>.</span><span class='rubyid_define identifier id'>define</span><span class='lparen token'>(</span><span class='string val'>&quot;manage_assessment_attributes&quot;</span><span class='comma token'>,</span>
                    <span class='string val'>&quot;The ability to managae assessment attribute definitions&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:level</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;repository&quot;</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="can_cancel_or_raise-instance_method">
  
    #<strong>can_cancel_or_raise</strong>(job)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


22
23
24</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'backend/app/controllers/job.rb', line 22</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_can_cancel_or_raise identifier id'>can_cancel_or_raise</span><span class='lparen token'>(</span><span class='rubyid_job identifier id'>job</span><span class='rparen token'>)</span>
  <span class='rubyid_has_permissions_or_raise identifier id'>has_permissions_or_raise</span><span class='lparen token'>(</span><span class='rubyid_job identifier id'>job</span><span class='comma token'>,</span> <span class='symbol val'>:cancel_permissions</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="can_create_or_raise-instance_method">
  
    #<strong>can_create_or_raise</strong>(job)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


17
18
19</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'backend/app/controllers/job.rb', line 17</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_can_create_or_raise identifier id'>can_create_or_raise</span><span class='lparen token'>(</span><span class='rubyid_job identifier id'>job</span><span class='rparen token'>)</span>
  <span class='rubyid_has_permissions_or_raise identifier id'>has_permissions_or_raise</span><span class='lparen token'>(</span><span class='rubyid_job identifier id'>job</span><span class='comma token'>,</span> <span class='symbol val'>:create_permissions</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="check_prefs_permissions-instance_method">
  
    #<strong>check_prefs_permissions</strong>(params)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'backend/app/controllers/preferences.rb', line 101</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_check_prefs_permissions identifier id'>check_prefs_permissions</span><span class='lparen token'>(</span><span class='rubyid_params identifier id'>params</span><span class='rparen token'>)</span>
  <span class='rubyid_if if kw'>if</span> <span class='lparen token'>(</span><span class='rubyid_params identifier id'>params</span><span class='dot token'>.</span><span class='rubyid_has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='symbol val'>:preference</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='rubyid_user_id identifier id'>user_id</span> <span class='assign token'>=</span> <span class='rubyid_params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:preference</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>&#39;user_id&#39;</span><span class='rbrack token'>]</span>
    <span class='rubyid_repo_id identifier id'>repo_id</span> <span class='assign token'>=</span> <span class='rubyid_params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:preference</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>&#39;repo_id&#39;</span><span class='rbrack token'>]</span>
  <span class='rubyid_else else kw'>else</span>
    <span class='rubyid_user_id identifier id'>user_id</span> <span class='assign token'>=</span> <span class='rubyid_Preference constant id'>Preference</span><span class='lbrack token'>[</span><span class='rubyid_params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:id</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_user_id identifier id'>user_id</span>
    <span class='rubyid_repo_id identifier id'>repo_id</span> <span class='assign token'>=</span> <span class='rubyid_params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:repo_id</span><span class='rbrack token'>]</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># trying to edit global prefs</span>
  <span class='rubyid_if if kw'>if</span> <span class='rubyid_user_id identifier id'>user_id</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span>
      <span class='rubyid_repo_id identifier id'>repo_id</span> <span class='eq op'>==</span> <span class='rubyid_Repository constant id'>Repository</span><span class='dot token'>.</span><span class='rubyid_global_repo_id identifier id'>global_repo_id</span> <span class='andop op'>&amp;&amp;</span>
      <span class='notop op'>!</span><span class='rubyid_current_user identifier id'>current_user</span><span class='dot token'>.</span><span class='rubyid_can? fid id'>can?</span><span class='lparen token'>(</span><span class='symbol val'>:administer_system</span><span class='rparen token'>)</span>
    <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_AccessDeniedException constant id'>AccessDeniedException</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&#39;Error editing Global preferences&#39;</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># trying to edit repo prefs</span>
  <span class='rubyid_if if kw'>if</span> <span class='rubyid_user_id identifier id'>user_id</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span>
      <span class='notop op'>!</span><span class='rubyid_current_user identifier id'>current_user</span><span class='dot token'>.</span><span class='rubyid_can? fid id'>can?</span><span class='lparen token'>(</span><span class='symbol val'>:manage_repository</span><span class='rparen token'>)</span>
    <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_AccessDeniedException constant id'>AccessDeniedException</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&#39;Error editing Repository preferences&#39;</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># trying to edit user prefs</span>
  <span class='rubyid_if if kw'>if</span> <span class='rubyid_user_id identifier id'>user_id</span> <span class='andop op'>&amp;&amp;</span> <span class='rubyid_user_id identifier id'>user_id</span> <span class='neq op'>!=</span> <span class='rubyid_current_user identifier id'>current_user</span><span class='dot token'>.</span><span class='rubyid_id identifier id'>id</span>
    <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_AccessDeniedException constant id'>AccessDeniedException</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&#39;Error editing User preferences&#39;</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="check_rde_permissions-instance_method">
  
    #<strong>check_rde_permissions</strong>(params)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


50
51
52
53
54</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'backend/app/controllers/rde_templates.rb', line 50</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_check_rde_permissions identifier id'>check_rde_permissions</span><span class='lparen token'>(</span><span class='rubyid_params identifier id'>params</span><span class='rparen token'>)</span>
  <span class='rubyid_if if kw'>if</span> <span class='notop op'>!</span><span class='rubyid_current_user identifier id'>current_user</span><span class='dot token'>.</span><span class='rubyid_can? fid id'>can?</span><span class='lparen token'>(</span><span class='symbol val'>:manage_rde_templates</span><span class='rparen token'>)</span>
    <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_AccessDeniedException constant id'>AccessDeniedException</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="current_user-instance_method">
  
    #<strong>current_user</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


228
229
230</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'backend/app/main.rb', line 228</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_current_user identifier id'>current_user</span>
  <span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='symbol val'>:aspace_user</span><span class='rbrack token'>]</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_entity_data-instance_method">
  
    #<strong>find_entity_data</strong>(ark)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'backend/app/controllers/ark_name.rb', line 17</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_find_entity_data identifier id'>find_entity_data</span><span class='lparen token'>(</span><span class='rubyid_ark identifier id'>ark</span><span class='rparen token'>)</span>
  <span class='rubyid_if if kw'>if</span> <span class='rubyid_ark identifier id'>ark</span><span class='dot token'>.</span><span class='rubyid_resource_id identifier id'>resource_id</span>
    <span class='rubyid_klass identifier id'>klass</span> <span class='assign token'>=</span> <span class='rubyid_Resource constant id'>Resource</span>
    <span class='rubyid_id identifier id'>id</span> <span class='assign token'>=</span> <span class='rubyid_ark identifier id'>ark</span><span class='dot token'>.</span><span class='rubyid_resource_id identifier id'>resource_id</span>
  <span class='rubyid_elsif elsif kw'>elsif</span> <span class='rubyid_ark identifier id'>ark</span><span class='dot token'>.</span><span class='rubyid_archival_object_id identifier id'>archival_object_id</span>
    <span class='rubyid_klass identifier id'>klass</span> <span class='assign token'>=</span> <span class='rubyid_ArchivalObject constant id'>ArchivalObject</span>
    <span class='rubyid_id identifier id'>id</span> <span class='assign token'>=</span> <span class='rubyid_ark identifier id'>ark</span><span class='dot token'>.</span><span class='rubyid_archival_object_id identifier id'>archival_object_id</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_rh identifier id'>rh</span> <span class='assign token'>=</span> <span class='rubyid_if if kw'>if</span> <span class='rubyid_entity identifier id'>entity</span> <span class='assign token'>=</span> <span class='rubyid_klass identifier id'>klass</span><span class='dot token'>.</span><span class='rubyid_any_repo identifier id'>any_repo</span><span class='dot token'>.</span><span class='rubyid_filter identifier id'>filter</span><span class='lparen token'>(</span><span class='symbol val'>:id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_id identifier id'>id</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_first identifier id'>first</span>
         <span class='rubyid_if if kw'>if</span> <span class='rubyid_entity identifier id'>entity</span><span class='dot token'>.</span><span class='rubyid_external_ark_url identifier id'>external_ark_url</span>
           <span class='lbrace token'>{</span><span class='string val'>&quot;type&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;external&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;external_url&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_entity identifier id'>entity</span><span class='dot token'>.</span><span class='rubyid_external_ark_url identifier id'>external_ark_url</span><span class='rbrace token'>}</span>
         <span class='rubyid_else else kw'>else</span>
           <span class='lbrace token'>{</span><span class='string val'>&quot;type&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_klass identifier id'>klass</span><span class='dot token'>.</span><span class='rubyid_to_s identifier id'>to_s</span><span class='comma token'>,</span>
            <span class='string val'>&quot;repo_id&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_entity identifier id'>entity</span><span class='lbrack token'>[</span><span class='symbol val'>:repo_id</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
            <span class='string val'>&quot;id&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_id identifier id'>id</span><span class='rbrace token'>}</span>
         <span class='rubyid_end end kw'>end</span>
       <span class='rubyid_else else kw'>else</span>
         <span class='lbrace token'>{</span><span class='string val'>&quot;type&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;not_found&quot;</span><span class='rbrace token'>}</span>
       <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_return return kw'>return</span> <span class='rubyid_rh identifier id'>rh</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="has_permissions_or_raise-instance_method">
  
    #<strong>has_permissions_or_raise</strong>(job, permissions)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Job runners can specify permissions required to create or cancel
particular types of jobs, so we have special handling for it here</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


6
7
8
9
10
11
12
13
14</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'backend/app/controllers/job.rb', line 6</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_has_permissions_or_raise identifier id'>has_permissions_or_raise</span><span class='lparen token'>(</span><span class='rubyid_job identifier id'>job</span><span class='comma token'>,</span> <span class='rubyid_permissions identifier id'>permissions</span><span class='rparen token'>)</span>
  <span class='rubyid_runner identifier id'>runner</span> <span class='assign token'>=</span> <span class='rubyid_JobRunner constant id'>JobRunner</span><span class='dot token'>.</span><span class='rubyid_registered_runner_for identifier id'>registered_runner_for</span><span class='lparen token'>(</span><span class='rubyid_job identifier id'>job</span><span class='lbrack token'>[</span><span class='string val'>&#39;job&#39;</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>&#39;jsonmodel_type&#39;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>

  <span class='rubyid_runner identifier id'>runner</span><span class='dot token'>.</span><span class='rubyid_send identifier id'>send</span><span class='lparen token'>(</span><span class='rubyid_permissions identifier id'>permissions</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_perm identifier id'>perm</span><span class='bitor op'>|</span>
    <span class='rubyid_unless unless kw'>unless</span> <span class='rubyid_current_user identifier id'>current_user</span><span class='dot token'>.</span><span class='rubyid_can? fid id'>can?</span><span class='lparen token'>(</span><span class='rubyid_perm identifier id'>perm</span><span class='rparen token'>)</span>
      <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_AccessDeniedException constant id'>AccessDeniedException</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;Access denied&quot;</span><span class='rparen token'>)</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="high_priority_request?-instance_method">
  
    #<strong>high_priority_request?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


233
234
235</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'backend/app/main.rb', line 233</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_high_priority_request? fid id'>high_priority_request?</span>
  <span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;HTTP_X_ARCHIVESSPACE_PRIORITY&quot;</span><span class='rbrack token'>]</span> <span class='andop op'>&amp;&amp;</span> <span class='lparen token'>(</span><span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;HTTP_X_ARCHIVESSPACE_PRIORITY&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_downcase identifier id'>downcase</span> <span class='eq op'>==</span> <span class='string val'>&quot;high&quot;</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="resolve_references_for_space_calculator-instance_method">
  
    #<strong>resolve_references_for_space_calculator</strong>(space_calculator)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


57
58
59
60
61
62
63
64
65
66</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'backend/app/controllers/space_calculator.rb', line 57</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_resolve_references_for_space_calculator identifier id'>resolve_references_for_space_calculator</span><span class='lparen token'>(</span><span class='rubyid_space_calculator identifier id'>space_calculator</span><span class='rparen token'>)</span>
  <span class='rubyid_refs_to_resolve identifier id'>refs_to_resolve</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='string val'>&#39;locations_with_space&#39;</span><span class='comma token'>,</span>
                     <span class='string val'>&#39;locations_with_space::location_profile&#39;</span><span class='comma token'>,</span>
                     <span class='string val'>&#39;locations_without_space&#39;</span><span class='comma token'>,</span>
                     <span class='string val'>&#39;locations_without_space::location_profile&#39;</span><span class='comma token'>,</span>
                     <span class='string val'>&#39;uncalculatable_locations&#39;</span><span class='comma token'>,</span>
                     <span class='string val'>&#39;uncalculatable_locations::location_profile&#39;</span><span class='rbrack token'>]</span>

  <span class='rubyid_resolve_references identifier id'>resolve_references</span><span class='lparen token'>(</span><span class='rubyid_space_calculator identifier id'>space_calculator</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span><span class='comma token'>,</span> <span class='rubyid_refs_to_resolve identifier id'>refs_to_resolve</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="session-instance_method">
  
    #<strong>session</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


223
224
225</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'backend/app/main.rb', line 223</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_session identifier id'>session</span>
  <span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='symbol val'>:aspace_session</span><span class='rbrack token'>]</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update_oai_config-instance_method">
  
    #<strong>update_oai_config</strong>(params)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'backend/app/controllers/oai_config.rb', line 40</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_update_oai_config identifier id'>update_oai_config</span><span class='lparen token'>(</span><span class='rubyid_params identifier id'>params</span><span class='rparen token'>)</span>
  <span class='rubyid_oc identifier id'>oc</span> <span class='assign token'>=</span> <span class='rubyid_OAIConfig constant id'>OAIConfig</span><span class='dot token'>.</span><span class='rubyid_first identifier id'>first</span>
  <span class='rubyid_json identifier id'>json</span> <span class='assign token'>=</span> <span class='rubyid_params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:oai_config</span><span class='rbrack token'>]</span>

  <span class='rubyid_oc identifier id'>oc</span><span class='dot token'>.</span><span class='rubyid_update identifier id'>update</span><span class='lparen token'>(</span><span class='symbol val'>:oai_repository_name</span>     <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&quot;oai_repository_name&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> 
            <span class='symbol val'>:oai_admin_email</span>         <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&quot;oai_admin_email&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> 
            <span class='symbol val'>:oai_record_prefix</span>       <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&quot;oai_record_prefix&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
            <span class='symbol val'>:repo_set_codes</span>          <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&quot;repo_set_codes&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
            <span class='symbol val'>:sponsor_set_names</span>       <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&quot;sponsor_set_names&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
            <span class='symbol val'>:repo_set_description</span>    <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&quot;repo_set_description&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
            <span class='symbol val'>:sponsor_set_description</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&quot;sponsor_set_description&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
            <span class='symbol val'>:repo_set_name</span>           <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&quot;repo_set_name&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
            <span class='symbol val'>:sponsor_set_name</span>        <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&quot;sponsor_set_name&quot;</span><span class='rbrack token'>]</span>
            <span class='rparen token'>)</span> 

  <span class='rubyid_updated_response identifier id'>updated_response</span><span class='lparen token'>(</span><span class='rubyid_oc identifier id'>oc</span><span class='comma token'>,</span> <span class='rubyid_json identifier id'>json</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  ArchivesSpace Version v2.8.0.a Documentation Generated on Thu Jul 16 10:06:59 2020 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.20.
</div>

    </div>
  </body>
</html>