<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: ImpliedPublicationCalculator
  
    &mdash; Documentation by YARD 0.9.12
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "ImpliedPublicationCalculator";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (I)</a> &raquo;
    
    
    <span class="title">ImpliedPublicationCalculator</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: ImpliedPublicationCalculator
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">ImpliedPublicationCalculator</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>backend/app/model/implied_publication_calculator.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>All of the for_* methods in this class take an array of Sequel model objects
and return a hash indicating whether each object can be considered to be
published by implication.</p>

<p>For example, you give it:</p>

<p>[subject1, subject2, subject3]</p>

<p>and it returns:</p>

<p>{
   subject1 =&gt; true,
   subject2 =&gt; false,
   subject3 =&gt; false
 }</p>

<p>meaning that subject1 was linked to at least one published record, while
subjects 2 and 3 were not (maybe they’re not linked to anything, or maybe only
to unpublished/suppressed records).</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#for_agents-instance_method" title="#for_agents (instance method)">#<strong>for_agents</strong>(agents)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>An agent is published if it’s linked to at least one archival record that’s published.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#for_subjects-instance_method" title="#for_subjects (instance method)">#<strong>for_subjects</strong>(subjects)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>An subject is published if it’s linked to at least one archival record that’s published.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#for_top_containers-instance_method" title="#for_top_containers (instance method)">#<strong>for_top_containers</strong>(top_containers)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>A top container is published if it’s linked (via an instance -&gt; sub_container) to at least one published record.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="for_agents-instance_method">
  
    #<strong>for_agents</strong>(agents)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>An agent is published if it’s linked to at least one archival record that’s
published.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'backend/app/model/implied_publication_calculator.rb', line 81</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_for_agents identifier id'>for_agents</span><span class='lparen token'>(</span><span class='rubyid_agents identifier id'>agents</span><span class='rparen token'>)</span>
  <span class='rubyid_return return kw'>return</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_agents identifier id'>agents</span><span class='dot token'>.</span><span class='rubyid_empty? fid id'>empty?</span>
  <span class='rubyid_assert_same_type! fid id'>assert_same_type!</span><span class='lparen token'>(</span><span class='rubyid_agents identifier id'>agents</span><span class='rparen token'>)</span>

  <span class='rubyid_agent_model identifier id'>agent_model</span> <span class='assign token'>=</span> <span class='rubyid_agents identifier id'>agents</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_class identifier id'>class</span>
  <span class='rubyid_result identifier id'>result</span> <span class='assign token'>=</span> <span class='rubyid_Hash constant id'>Hash</span><span class='lbrack token'>[</span><span class='rubyid_agents identifier id'>agents</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_node identifier id'>node</span><span class='bitor op'>|</span> <span class='lbrack token'>[</span><span class='rubyid_node identifier id'>node</span><span class='comma token'>,</span> <span class='rubyid_false false kw'>false</span><span class='rbrack token'>]</span><span class='rbrace token'>}</span><span class='rbrack token'>]</span>
  <span class='rubyid_agents_by_id identifier id'>agents_by_id</span> <span class='assign token'>=</span> <span class='rubyid_Hash constant id'>Hash</span><span class='lbrack token'>[</span><span class='rubyid_agents identifier id'>agents</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_agent identifier id'>agent</span><span class='bitor op'>|</span> <span class='lbrack token'>[</span><span class='rubyid_agent identifier id'>agent</span><span class='dot token'>.</span><span class='rubyid_id identifier id'>id</span><span class='comma token'>,</span> <span class='rubyid_agent identifier id'>agent</span><span class='rbrack token'>]</span><span class='rbrace token'>}</span><span class='rbrack token'>]</span>

  <span class='rubyid_agent_model identifier id'>agent_model</span><span class='dot token'>.</span><span class='rubyid_relationship_dependencies identifier id'>relationship_dependencies</span><span class='lbrack token'>[</span><span class='symbol val'>:linked_agents</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_model identifier id'>model</span><span class='bitor op'>|</span>

    <span class='comment val'># Things like events aren&#39;t publishable and shouldn&#39;t count for these calculations</span>
    <span class='rubyid_next next kw'>next</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_model identifier id'>model</span><span class='dot token'>.</span><span class='rubyid_included_modules identifier id'>included_modules</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_Publishable constant id'>Publishable</span><span class='rparen token'>)</span>

    <span class='rubyid_link_relationship identifier id'>link_relationship</span> <span class='assign token'>=</span> <span class='rubyid_model identifier id'>model</span><span class='dot token'>.</span><span class='rubyid_find_relationship identifier id'>find_relationship</span><span class='lparen token'>(</span><span class='symbol val'>:linked_agents</span><span class='rparen token'>)</span>

    <span class='comment val'># agent_person_rlshp</span>
    <span class='rubyid_link_table identifier id'>link_table</span> <span class='assign token'>=</span> <span class='rubyid_link_relationship identifier id'>link_relationship</span><span class='dot token'>.</span><span class='rubyid_table_name identifier id'>table_name</span>

    <span class='rubyid_link_relationship identifier id'>link_relationship</span><span class='dot token'>.</span><span class='rubyid_reference_columns_for identifier id'>reference_columns_for</span><span class='lparen token'>(</span><span class='rubyid_model identifier id'>model</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_model_link_column identifier id'>model_link_column</span><span class='bitor op'>|</span>
      <span class='rubyid_link_relationship identifier id'>link_relationship</span><span class='dot token'>.</span><span class='rubyid_reference_columns_for identifier id'>reference_columns_for</span><span class='lparen token'>(</span><span class='rubyid_agent_model identifier id'>agent_model</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_agent_link_column identifier id'>agent_link_column</span><span class='bitor op'>|</span>
        <span class='rubyid_linked_records identifier id'>linked_records</span> <span class='assign token'>=</span> <span class='rubyid_model identifier id'>model</span>
                           <span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_link_table identifier id'>link_table</span><span class='comma token'>,</span>
                                 <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_link_table identifier id'>link_table</span><span class='comma token'>,</span> <span class='rubyid_model_link_column identifier id'>model_link_column</span><span class='rparen token'>)</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_model identifier id'>model</span><span class='dot token'>.</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='symbol val'>:id</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
                           <span class='dot token'>.</span><span class='rubyid_filter identifier id'>filter</span><span class='lparen token'>(</span><span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_link_table identifier id'>link_table</span><span class='comma token'>,</span> <span class='rubyid_agent_link_column identifier id'>agent_link_column</span><span class='rparen token'>)</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_agents_by_id identifier id'>agents_by_id</span><span class='dot token'>.</span><span class='rubyid_keys identifier id'>keys</span><span class='rparen token'>)</span>
                           <span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span><span class='lparen token'>(</span><span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_model identifier id'>model</span><span class='dot token'>.</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='symbol val'>:id</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                   <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_model identifier id'>model</span><span class='dot token'>.</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='symbol val'>:publish</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                   <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_model identifier id'>model</span><span class='dot token'>.</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='symbol val'>:suppressed</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                   <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_as identifier id'>as</span><span class='lparen token'>(</span><span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_link_table identifier id'>link_table</span><span class='comma token'>,</span> <span class='rubyid_agent_link_column identifier id'>agent_link_column</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                             <span class='symbol val'>:agent_id</span><span class='rparen token'>)</span><span class='rparen token'>)</span>

        <span class='rubyid_if if kw'>if</span> <span class='rubyid_model identifier id'>model</span><span class='dot token'>.</span><span class='rubyid_columns identifier id'>columns</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='symbol val'>:repo_id</span><span class='rparen token'>)</span>
          <span class='rubyid_linked_records identifier id'>linked_records</span> <span class='assign token'>=</span> <span class='rubyid_linked_records identifier id'>linked_records</span>
                             <span class='dot token'>.</span><span class='rubyid_select_append identifier id'>select_append</span><span class='lparen token'>(</span><span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_as identifier id'>as</span><span class='lparen token'>(</span><span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_model identifier id'>model</span><span class='dot token'>.</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='symbol val'>:repo_id</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                                      <span class='symbol val'>:repository_id</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>

        <span class='rubyid_published_status identifier id'>published_status</span> <span class='assign token'>=</span> <span class='rubyid_if if kw'>if</span> <span class='rubyid_model identifier id'>model</span><span class='dot token'>.</span><span class='rubyid_included_modules identifier id'>included_modules</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_TreeNodes constant id'>TreeNodes</span><span class='rparen token'>)</span>
                             <span class='rubyid_for_tree_nodes identifier id'>for_tree_nodes</span><span class='lparen token'>(</span><span class='rubyid_linked_records identifier id'>linked_records</span>
                                              <span class='dot token'>.</span><span class='rubyid_select_append identifier id'>select_append</span><span class='lparen token'>(</span><span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_model identifier id'>model</span><span class='dot token'>.</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='symbol val'>:parent_id</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                                             <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_model identifier id'>model</span><span class='dot token'>.</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='symbol val'>:root_record_id</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
                                              <span class='dot token'>.</span><span class='rubyid_all identifier id'>all</span><span class='rparen token'>)</span>
                           <span class='rubyid_else else kw'>else</span>
                             <span class='rubyid_for_top_level_records identifier id'>for_top_level_records</span><span class='lparen token'>(</span><span class='rubyid_linked_records identifier id'>linked_records</span><span class='dot token'>.</span><span class='rubyid_all identifier id'>all</span><span class='rparen token'>)</span>
                           <span class='rubyid_end end kw'>end</span>

        <span class='rubyid_published_status identifier id'>published_status</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_linked_record identifier id'>linked_record</span><span class='comma token'>,</span> <span class='rubyid_published identifier id'>published</span><span class='bitor op'>|</span>
          <span class='rubyid_if if kw'>if</span> <span class='rubyid_published identifier id'>published</span>
            <span class='rubyid_result identifier id'>result</span><span class='lbrack token'>[</span><span class='rubyid_agents_by_id identifier id'>agents_by_id</span><span class='dot token'>.</span><span class='rubyid_fetch identifier id'>fetch</span><span class='lparen token'>(</span><span class='rubyid_linked_record identifier id'>linked_record</span><span class='lbrack token'>[</span><span class='symbol val'>:agent_id</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
          <span class='rubyid_end end kw'>end</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_result identifier id'>result</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="for_subjects-instance_method">
  
    #<strong>for_subjects</strong>(subjects)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>An subject is published if it’s linked to at least one archival record that’s
published.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'backend/app/model/implied_publication_calculator.rb', line 140</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_for_subjects identifier id'>for_subjects</span><span class='lparen token'>(</span><span class='rubyid_subjects identifier id'>subjects</span><span class='rparen token'>)</span>
  <span class='rubyid_result identifier id'>result</span> <span class='assign token'>=</span> <span class='rubyid_Hash constant id'>Hash</span><span class='lbrack token'>[</span><span class='rubyid_subjects identifier id'>subjects</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_node identifier id'>node</span><span class='bitor op'>|</span> <span class='lbrack token'>[</span><span class='rubyid_node identifier id'>node</span><span class='comma token'>,</span> <span class='rubyid_false false kw'>false</span><span class='rbrack token'>]</span><span class='rbrace token'>}</span><span class='rbrack token'>]</span>
  <span class='rubyid_subjects_by_id identifier id'>subjects_by_id</span> <span class='assign token'>=</span> <span class='rubyid_Hash constant id'>Hash</span><span class='lbrack token'>[</span><span class='rubyid_subjects identifier id'>subjects</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_subject identifier id'>subject</span><span class='bitor op'>|</span> <span class='lbrack token'>[</span><span class='rubyid_subject identifier id'>subject</span><span class='dot token'>.</span><span class='rubyid_id identifier id'>id</span><span class='comma token'>,</span> <span class='rubyid_subject identifier id'>subject</span><span class='rbrack token'>]</span><span class='rbrace token'>}</span><span class='rbrack token'>]</span>

  <span class='rubyid_Subject constant id'>Subject</span><span class='dot token'>.</span><span class='rubyid_relationship_dependencies identifier id'>relationship_dependencies</span><span class='lbrack token'>[</span><span class='symbol val'>:subject</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_model identifier id'>model</span><span class='bitor op'>|</span>
    <span class='rubyid_link_relationship identifier id'>link_relationship</span> <span class='assign token'>=</span> <span class='rubyid_model identifier id'>model</span><span class='dot token'>.</span><span class='rubyid_find_relationship identifier id'>find_relationship</span><span class='lparen token'>(</span><span class='symbol val'>:subject</span><span class='rparen token'>)</span>

    <span class='comment val'># subject_rlshp</span>
    <span class='rubyid_link_table identifier id'>link_table</span> <span class='assign token'>=</span> <span class='rubyid_link_relationship identifier id'>link_relationship</span><span class='dot token'>.</span><span class='rubyid_table_name identifier id'>table_name</span>

    <span class='rubyid_link_relationship identifier id'>link_relationship</span><span class='dot token'>.</span><span class='rubyid_reference_columns_for identifier id'>reference_columns_for</span><span class='lparen token'>(</span><span class='rubyid_model identifier id'>model</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_model_link_column identifier id'>model_link_column</span><span class='bitor op'>|</span>
      <span class='rubyid_link_relationship identifier id'>link_relationship</span><span class='dot token'>.</span><span class='rubyid_reference_columns_for identifier id'>reference_columns_for</span><span class='lparen token'>(</span><span class='rubyid_Subject constant id'>Subject</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_subject_link_column identifier id'>subject_link_column</span><span class='bitor op'>|</span>
        <span class='comment val'># Join subject_rlshp to (e.g.) accession</span>
        <span class='rubyid_linked_records identifier id'>linked_records</span> <span class='assign token'>=</span> <span class='rubyid_model identifier id'>model</span>
                           <span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_link_table identifier id'>link_table</span><span class='comma token'>,</span>
                                 <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_link_table identifier id'>link_table</span><span class='comma token'>,</span> <span class='rubyid_model_link_column identifier id'>model_link_column</span><span class='rparen token'>)</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_model identifier id'>model</span><span class='dot token'>.</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='symbol val'>:id</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
                           <span class='dot token'>.</span><span class='rubyid_filter identifier id'>filter</span><span class='lparen token'>(</span><span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_link_table identifier id'>link_table</span><span class='comma token'>,</span> <span class='rubyid_subject_link_column identifier id'>subject_link_column</span><span class='rparen token'>)</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_subjects_by_id identifier id'>subjects_by_id</span><span class='dot token'>.</span><span class='rubyid_keys identifier id'>keys</span><span class='rparen token'>)</span>
                           <span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span><span class='lparen token'>(</span><span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_model identifier id'>model</span><span class='dot token'>.</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='symbol val'>:id</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                   <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_model identifier id'>model</span><span class='dot token'>.</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='symbol val'>:publish</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                   <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_model identifier id'>model</span><span class='dot token'>.</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='symbol val'>:suppressed</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                   <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_as identifier id'>as</span><span class='lparen token'>(</span><span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_link_table identifier id'>link_table</span><span class='comma token'>,</span> <span class='rubyid_subject_link_column identifier id'>subject_link_column</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                             <span class='symbol val'>:subject_id</span><span class='rparen token'>)</span><span class='rparen token'>)</span>

        <span class='rubyid_if if kw'>if</span> <span class='rubyid_model identifier id'>model</span><span class='dot token'>.</span><span class='rubyid_columns identifier id'>columns</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='symbol val'>:repo_id</span><span class='rparen token'>)</span>
          <span class='rubyid_linked_records identifier id'>linked_records</span> <span class='assign token'>=</span> <span class='rubyid_linked_records identifier id'>linked_records</span>
                             <span class='dot token'>.</span><span class='rubyid_select_append identifier id'>select_append</span><span class='lparen token'>(</span><span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_as identifier id'>as</span><span class='lparen token'>(</span><span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_model identifier id'>model</span><span class='dot token'>.</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='symbol val'>:repo_id</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                                      <span class='symbol val'>:repository_id</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>

        <span class='rubyid_published_status identifier id'>published_status</span> <span class='assign token'>=</span> <span class='rubyid_if if kw'>if</span> <span class='rubyid_model identifier id'>model</span><span class='dot token'>.</span><span class='rubyid_included_modules identifier id'>included_modules</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_TreeNodes constant id'>TreeNodes</span><span class='rparen token'>)</span>
                             <span class='rubyid_for_tree_nodes identifier id'>for_tree_nodes</span><span class='lparen token'>(</span><span class='rubyid_linked_records identifier id'>linked_records</span>
                                                        <span class='dot token'>.</span><span class='rubyid_select_append identifier id'>select_append</span><span class='lparen token'>(</span><span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_model identifier id'>model</span><span class='dot token'>.</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='symbol val'>:parent_id</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                                                       <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_model identifier id'>model</span><span class='dot token'>.</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='symbol val'>:root_record_id</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
                                                        <span class='dot token'>.</span><span class='rubyid_all identifier id'>all</span><span class='rparen token'>)</span>
                           <span class='rubyid_else else kw'>else</span>
                             <span class='rubyid_for_top_level_records identifier id'>for_top_level_records</span><span class='lparen token'>(</span><span class='rubyid_linked_records identifier id'>linked_records</span><span class='dot token'>.</span><span class='rubyid_all identifier id'>all</span><span class='rparen token'>)</span>
                           <span class='rubyid_end end kw'>end</span>

        <span class='rubyid_published_status identifier id'>published_status</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_linked_record identifier id'>linked_record</span><span class='comma token'>,</span> <span class='rubyid_published identifier id'>published</span><span class='bitor op'>|</span>
          <span class='rubyid_if if kw'>if</span> <span class='rubyid_published identifier id'>published</span>
            <span class='rubyid_result identifier id'>result</span><span class='lbrack token'>[</span><span class='rubyid_subjects_by_id identifier id'>subjects_by_id</span><span class='dot token'>.</span><span class='rubyid_fetch identifier id'>fetch</span><span class='lparen token'>(</span><span class='rubyid_linked_record identifier id'>linked_record</span><span class='lbrack token'>[</span><span class='symbol val'>:subject_id</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
          <span class='rubyid_end end kw'>end</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_result identifier id'>result</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="for_top_containers-instance_method">
  
    #<strong>for_top_containers</strong>(top_containers)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>A top container is published if it’s linked (via an instance -&gt;
sub_container) to at least one published record</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'backend/app/model/implied_publication_calculator.rb', line 26</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_for_top_containers identifier id'>for_top_containers</span><span class='lparen token'>(</span><span class='rubyid_top_containers identifier id'>top_containers</span><span class='rparen token'>)</span>
  <span class='rubyid_top_containers_by_id identifier id'>top_containers_by_id</span> <span class='assign token'>=</span> <span class='rubyid_Hash constant id'>Hash</span><span class='lbrack token'>[</span><span class='rubyid_top_containers identifier id'>top_containers</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_top_container identifier id'>top_container</span><span class='bitor op'>|</span> <span class='lbrack token'>[</span><span class='rubyid_top_container identifier id'>top_container</span><span class='dot token'>.</span><span class='rubyid_id identifier id'>id</span><span class='comma token'>,</span> <span class='rubyid_top_container identifier id'>top_container</span><span class='rbrack token'>]</span><span class='rbrace token'>}</span><span class='rbrack token'>]</span>
  <span class='rubyid_result identifier id'>result</span> <span class='assign token'>=</span> <span class='rubyid_Hash constant id'>Hash</span><span class='lbrack token'>[</span><span class='rubyid_top_containers identifier id'>top_containers</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_top_container identifier id'>top_container</span><span class='bitor op'>|</span> <span class='lbrack token'>[</span><span class='rubyid_top_container identifier id'>top_container</span><span class='comma token'>,</span> <span class='rubyid_false false kw'>false</span><span class='rbrack token'>]</span><span class='rbrace token'>}</span><span class='rbrack token'>]</span>

  <span class='rubyid_Instance constant id'>Instance</span><span class='dot token'>.</span><span class='rubyid_enclosing_associations identifier id'>enclosing_associations</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_association identifier id'>association</span><span class='bitor op'>|</span>
    <span class='rubyid_model identifier id'>model</span> <span class='assign token'>=</span> <span class='rubyid_association identifier id'>association</span><span class='lbrack token'>[</span><span class='symbol val'>:model</span><span class='rbrack token'>]</span>
    <span class='rubyid_model_table identifier id'>model_table</span> <span class='assign token'>=</span> <span class='rubyid_model identifier id'>model</span><span class='dot token'>.</span><span class='rubyid_table_name identifier id'>table_name</span>

    <span class='rubyid_top_container_link identifier id'>top_container_link</span> <span class='assign token'>=</span> <span class='rubyid_SubContainer constant id'>SubContainer</span><span class='dot token'>.</span><span class='rubyid_find_relationship identifier id'>find_relationship</span><span class='lparen token'>(</span><span class='symbol val'>:top_container_link</span><span class='rparen token'>)</span>

    <span class='comment val'># Join our (e.g.) Accession to an Instance, then Instance to SubContainer,</span>
    <span class='comment val'># then SubContainer to TopContainer.</span>
    <span class='rubyid_joined_ds identifier id'>joined_ds</span> <span class='assign token'>=</span> <span class='rubyid_model identifier id'>model</span>
                  <span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='symbol val'>:instance</span><span class='comma token'>,</span> <span class='rubyid_association identifier id'>association</span><span class='lbrack token'>[</span><span class='symbol val'>:key</span><span class='rbrack token'>]</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_model_table identifier id'>model_table</span><span class='comma token'>,</span> <span class='symbol val'>:id</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
                  <span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='symbol val'>:sub_container</span><span class='comma token'>,</span> <span class='symbol val'>:instance_id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='symbol val'>:instance</span><span class='comma token'>,</span> <span class='symbol val'>:id</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
                  <span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_top_container_link identifier id'>top_container_link</span><span class='dot token'>.</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='symbol val'>:sub_container_id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='symbol val'>:sub_container</span><span class='comma token'>,</span> <span class='symbol val'>:id</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
                  <span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='symbol val'>:top_container</span><span class='comma token'>,</span> <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='symbol val'>:top_container</span><span class='comma token'>,</span> <span class='symbol val'>:id</span><span class='rparen token'>)</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_top_container_link identifier id'>top_container_link</span><span class='dot token'>.</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='symbol val'>:top_container_id</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
                  <span class='dot token'>.</span><span class='rubyid_filter identifier id'>filter</span><span class='lparen token'>(</span><span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='symbol val'>:top_container</span><span class='comma token'>,</span> <span class='symbol val'>:id</span><span class='rparen token'>)</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_top_containers_by_id identifier id'>top_containers_by_id</span><span class='dot token'>.</span><span class='rubyid_keys identifier id'>keys</span><span class='rparen token'>)</span>

    <span class='rubyid_linked_records identifier id'>linked_records</span> <span class='assign token'>=</span> <span class='rubyid_if if kw'>if</span> <span class='rubyid_model identifier id'>model</span><span class='dot token'>.</span><span class='rubyid_included_modules identifier id'>included_modules</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_TreeNodes constant id'>TreeNodes</span><span class='rparen token'>)</span>
                       <span class='rubyid_for_tree_nodes identifier id'>for_tree_nodes</span><span class='lparen token'>(</span><span class='rubyid_joined_ds identifier id'>joined_ds</span>
                                        <span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span><span class='lparen token'>(</span><span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_model_table identifier id'>model_table</span><span class='comma token'>,</span> <span class='symbol val'>:id</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                                <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_model_table identifier id'>model_table</span><span class='comma token'>,</span> <span class='symbol val'>:parent_id</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                                <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_model_table identifier id'>model_table</span><span class='comma token'>,</span> <span class='symbol val'>:root_record_id</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                                <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_model_table identifier id'>model_table</span><span class='comma token'>,</span> <span class='symbol val'>:publish</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                                <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_model_table identifier id'>model_table</span><span class='comma token'>,</span> <span class='symbol val'>:suppressed</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                                <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_as identifier id'>as</span><span class='lparen token'>(</span><span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_model_table identifier id'>model_table</span><span class='comma token'>,</span> <span class='symbol val'>:repo_id</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                                          <span class='symbol val'>:repository_id</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                                <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_as identifier id'>as</span><span class='lparen token'>(</span><span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='symbol val'>:top_container</span><span class='comma token'>,</span> <span class='symbol val'>:id</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                                          <span class='symbol val'>:top_container_id</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
                                        <span class='dot token'>.</span><span class='rubyid_all identifier id'>all</span><span class='rparen token'>)</span>
                     <span class='rubyid_else else kw'>else</span>
                       <span class='rubyid_for_top_level_records identifier id'>for_top_level_records</span><span class='lparen token'>(</span><span class='rubyid_joined_ds identifier id'>joined_ds</span>
                                               <span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span><span class='lparen token'>(</span><span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_model_table identifier id'>model_table</span><span class='comma token'>,</span> <span class='symbol val'>:id</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                                       <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_model_table identifier id'>model_table</span><span class='comma token'>,</span> <span class='symbol val'>:publish</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                                       <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_model_table identifier id'>model_table</span><span class='comma token'>,</span> <span class='symbol val'>:suppressed</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                                       <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_as identifier id'>as</span><span class='lparen token'>(</span><span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='rubyid_model_table identifier id'>model_table</span><span class='comma token'>,</span> <span class='symbol val'>:repo_id</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                                                 <span class='symbol val'>:repository_id</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                                       <span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_as identifier id'>as</span><span class='lparen token'>(</span><span class='rubyid_Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='rubyid_qualify identifier id'>qualify</span><span class='lparen token'>(</span><span class='symbol val'>:top_container</span><span class='comma token'>,</span> <span class='symbol val'>:id</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                                                                 <span class='symbol val'>:top_container_id</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
                                               <span class='dot token'>.</span><span class='rubyid_all identifier id'>all</span><span class='rparen token'>)</span>
                     <span class='rubyid_end end kw'>end</span>

    <span class='rubyid_linked_records identifier id'>linked_records</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_linked_record identifier id'>linked_record</span><span class='comma token'>,</span> <span class='rubyid_published identifier id'>published</span><span class='bitor op'>|</span>
      <span class='rubyid_if if kw'>if</span> <span class='rubyid_published identifier id'>published</span>
        <span class='rubyid_result identifier id'>result</span><span class='lbrack token'>[</span><span class='rubyid_top_containers_by_id identifier id'>top_containers_by_id</span><span class='dot token'>.</span><span class='rubyid_fetch identifier id'>fetch</span><span class='lparen token'>(</span><span class='rubyid_linked_record identifier id'>linked_record</span><span class='lbrack token'>[</span><span class='symbol val'>:top_container_id</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_published identifier id'>published</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_result identifier id'>result</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  ArchivesSpace Version fix-date-range-search Documentation Generated on Thu Jun 21 10:19:26 2018 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.12 (ruby-2.3.3).
</div>
    </div>
  </body>
</html>