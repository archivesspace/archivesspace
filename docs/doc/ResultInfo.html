<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: ResultInfo
  
    &mdash; Documentation by YARD 0.9.20
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "ResultInfo";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="alpha_index.html">Index (R)</a> &raquo;
    
    
    <span class="title">ResultInfo</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: ResultInfo
  
  
  
</h1>
<div class="box_info">
  

  
  
  <dl>
      <dt>Extended by:</dt>
      <dd>ActiveSupport::Concern</dd>
  </dl>
  
  
  
  

  
  <dl>
    <dt>Included in:</dt>
    <dd><span class='object_link'><a href="AccessionsController.html" title="AccessionsController (class)">AccessionsController</a></span>, <span class='object_link'><a href="AgentsController.html" title="AgentsController (class)">AgentsController</a></span>, <span class='object_link'><a href="ClassificationsController.html" title="ClassificationsController (class)">ClassificationsController</a></span>, <span class='object_link'><a href="ObjectsController.html" title="ObjectsController (class)">ObjectsController</a></span>, <span class='object_link'><a href="RepositoriesController.html" title="RepositoriesController (class)">RepositoriesController</a></span>, <span class='object_link'><a href="ResourcesController.html" title="ResourcesController (class)">ResourcesController</a></span>, <span class='object_link'><a href="SubjectsController.html" title="SubjectsController (class)">SubjectsController</a></span></dd>
  </dl>
  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>public/app/controllers/concerns/result_info.rb</dd>
  </dl>
  
</div>








  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#breadcrumb_info-instance_method" title="#breadcrumb_info (instance method)">#<strong>breadcrumb_info</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>create the breadcrumbs.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#fill_request_info-instance_method" title="#fill_request_info (instance method)">#<strong>fill_request_info</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_rep_image-instance_method" title="#get_rep_image (instance method)">#<strong>get_rep_image</strong>(instances)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>look for a representative instance.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#handle_dates-instance_method" title="#handle_dates (instance method)">#<strong>handle_dates</strong>(json)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>handle dates.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#handle_external_docs-instance_method" title="#handle_external_docs (instance method)">#<strong>handle_external_docs</strong>(json)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#process_agents-instance_method" title="#process_agents (instance method)">#<strong>process_agents</strong>(agents_arr, subjects_arr = [])  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>create a usable agent hash.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#process_digital-instance_method" title="#process_digital (instance method)">#<strong>process_digital</strong>(json)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>digital object processing.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#process_digital_instance-instance_method" title="#process_digital_instance (instance method)">#<strong>process_digital_instance</strong>(instances)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>representative digital object for an archival object.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#process_extents-instance_method" title="#process_extents (instance method)">#<strong>process_extents</strong>(json)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>process extents for display; format per Mark Custer.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#process_file_versions-instance_method" title="#process_file_versions (instance method)">#<strong>process_file_versions</strong>(json)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>get links (including thumbnail, caption) for <em>one</em> digital object.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#process_repo_info-instance_method" title="#process_repo_info (instance method)">#<strong>process_repo_info</strong>(repo)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>extract the repository agent info.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#process_subjects-instance_method" title="#process_subjects (instance method)">#<strong>process_subjects</strong>(subjects_arr)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>create a usable subjects array.</p>
</div></span>
  
</li>

      
    </ul>
  


  

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="breadcrumb_info-instance_method">
  
    #<strong>breadcrumb_info</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>create the breadcrumbs</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5
6
7
8
9
10
11
12
13
14
15
16
17</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'public/app/controllers/concerns/result_info.rb', line 5</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_breadcrumb_info identifier id'>breadcrumb_info</span>
  <span class='rubyid_context identifier id'>context</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span> <span class='comment val'># FIXME get_path(@tree)</span>
  <span class='rubyid_path identifier id'>path</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span> <span class='comment val'># FIXME @tree.dig(&#39;path_to_root&#39;)</span>
  <span class='rubyid_unless unless kw'>unless</span> <span class='notop op'>!</span><span class='rubyid_path identifier id'>path</span> <span class='orop op'>||</span> <span class='notop op'>!</span><span class='rubyid_path identifier id'>path</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_Array constant id'>Array</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='rubyid_path identifier id'>path</span><span class='dot token'>.</span><span class='rubyid_size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
    <span class='rubyid_type identifier id'>type</span> <span class='assign token'>=</span> <span class='rubyid_path identifier id'>path</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_dig identifier id'>dig</span><span class='lparen token'>(</span><span class='string val'>&#39;node_type&#39;</span><span class='rparen token'>)</span>
    <span class='rubyid_unless unless kw'>unless</span> <span class='rubyid_type identifier id'>type</span> <span class='eq op'>==</span> <span class='string val'>&#39;repository&#39;</span> <span class='orop op'>||</span> <span class='notop op'>!</span><span class='rubyid_@repo_info ivar id'>@repo_info</span><span class='dot token'>.</span><span class='rubyid_dig identifier id'>dig</span><span class='lparen token'>(</span><span class='string val'>&#39;top&#39;</span><span class='comma token'>,</span><span class='string val'>&#39;uri&#39;</span><span class='rparen token'>)</span>
      <span class='rubyid_context identifier id'>context</span><span class='dot token'>.</span><span class='rubyid_unshift identifier id'>unshift</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:uri</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_@repo_info ivar id'>@repo_info</span><span class='lbrack token'>[</span><span class='string val'>&#39;top&#39;</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>&#39;uri&#39;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                        <span class='symbol val'>:crumb</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_strip_mixed_content identifier id'>strip_mixed_content</span><span class='lparen token'>(</span><span class='rubyid_@repo_info ivar id'>@repo_info</span><span class='lbrack token'>[</span><span class='string val'>&#39;top&#39;</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>&#39;name&#39;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_context identifier id'>context</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:uri</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&#39;&#39;</span><span class='comma token'>,</span> <span class='symbol val'>:crumb</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_strip_mixed_content identifier id'>strip_mixed_content</span><span class='lparen token'>(</span><span class='rubyid_@result ivar id'>@result</span><span class='lbrack token'>[</span><span class='string val'>&#39;json&#39;</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>&#39;display_string&#39;</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='rubyid_@result ivar id'>@result</span><span class='lbrack token'>[</span><span class='string val'>&#39;json&#39;</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>&#39;title&#39;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='rubyid_context identifier id'>context</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="fill_request_info-instance_method">
  
    #<strong>fill_request_info</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


19
20
21
22
23</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'public/app/controllers/concerns/result_info.rb', line 19</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_fill_request_info identifier id'>fill_request_info</span>
  <span class='rubyid_@request ivar id'>@request</span> <span class='assign token'>=</span> <span class='rubyid_@result ivar id'>@result</span><span class='dot token'>.</span><span class='rubyid_request_item identifier id'>request_item</span>

  <span class='rubyid_@request ivar id'>@request</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_rep_image-instance_method">
  
    #<strong>get_rep_image</strong>(instances)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>look for a representative instance</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'public/app/controllers/concerns/result_info.rb', line 226</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_get_rep_image identifier id'>get_rep_image</span><span class='lparen token'>(</span><span class='rubyid_instances identifier id'>instances</span><span class='rparen token'>)</span>
  <span class='rubyid_rep identifier id'>rep</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='rubyid_if if kw'>if</span> <span class='rubyid_instances identifier id'>instances</span> <span class='andop op'>&amp;&amp;</span> <span class='rubyid_instances identifier id'>instances</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_Array constant id'>Array</span><span class='rparen token'>)</span>
    <span class='rubyid_instances identifier id'>instances</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_instance identifier id'>instance</span><span class='bitor op'>|</span>
      <span class='rubyid_unless unless kw'>unless</span> <span class='rubyid_instance identifier id'>instance</span><span class='lbrack token'>[</span><span class='string val'>&#39;digital_object&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span> <span class='orop op'>||</span> <span class='rubyid_instance identifier id'>instance</span><span class='lbrack token'>[</span><span class='string val'>&#39;digital_object&#39;</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>&#39;_resolved&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span>
        <span class='rubyid_it identifier id'>it</span> <span class='assign token'>=</span>  <span class='rubyid_instance identifier id'>instance</span><span class='lbrack token'>[</span><span class='string val'>&#39;digital_object&#39;</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>&#39;_resolved&#39;</span><span class='rbrack token'>]</span>
        <span class='rubyid_unless unless kw'>unless</span> <span class='notop op'>!</span><span class='rubyid_it identifier id'>it</span><span class='lbrack token'>[</span><span class='string val'>&#39;publish&#39;</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='rubyid_it identifier id'>it</span><span class='lbrack token'>[</span><span class='string val'>&#39;file_versions&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span>
          <span class='rubyid_it identifier id'>it</span><span class='lbrack token'>[</span><span class='string val'>&#39;file_versions&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_ver identifier id'>ver</span><span class='bitor op'>|</span>
            <span class='rubyid_if if kw'>if</span> <span class='rubyid_ver identifier id'>ver</span><span class='lbrack token'>[</span><span class='string val'>&#39;is_representative&#39;</span><span class='rbrack token'>]</span> <span class='andop op'>&amp;&amp;</span> <span class='rubyid_ver identifier id'>ver</span><span class='lbrack token'>[</span><span class='string val'>&#39;xlink_show_attribute&#39;</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='string val'>&#39;embed&#39;</span> <span class='andop op'>&amp;&amp;</span> <span class='rubyid_ver identifier id'>ver</span><span class='lbrack token'>[</span><span class='string val'>&#39;publish&#39;</span><span class='rbrack token'>]</span>
              <span class='rubyid_rep identifier id'>rep</span><span class='lbrack token'>[</span><span class='string val'>&#39;title&#39;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_strip_mixed_content identifier id'>strip_mixed_content</span><span class='lparen token'>(</span><span class='rubyid_it identifier id'>it</span><span class='lbrack token'>[</span><span class='string val'>&#39;title&#39;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
              <span class='rubyid_rep identifier id'>rep</span><span class='lbrack token'>[</span><span class='string val'>&#39;uri&#39;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_ver identifier id'>ver</span><span class='lbrack token'>[</span><span class='string val'>&#39;file_uri&#39;</span><span class='rbrack token'>]</span>
            <span class='rubyid_end end kw'>end</span>
          <span class='rubyid_end end kw'>end</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_rep identifier id'>rep</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="handle_dates-instance_method">
  
    #<strong>handle_dates</strong>(json)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>handle dates</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'public/app/controllers/concerns/result_info.rb', line 27</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_handle_dates identifier id'>handle_dates</span><span class='lparen token'>(</span><span class='rubyid_json identifier id'>json</span><span class='rparen token'>)</span>
  <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&#39;html&#39;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span> <span class='rubyid_if if_mod kw'>if</span> <span class='notop op'>!</span><span class='rubyid_json identifier id'>json</span><span class='dot token'>.</span><span class='rubyid_dig identifier id'>dig</span><span class='lparen token'>(</span><span class='string val'>&#39;html&#39;</span><span class='rparen token'>)</span>
  <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&#39;html&#39;</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>&#39;dates&#39;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&#39;dates&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_date identifier id'>date</span><span class='bitor op'>|</span>
    <span class='rubyid_label identifier id'>label</span> <span class='assign token'>=</span> <span class='rubyid_date identifier id'>date</span><span class='lbrack token'>[</span><span class='string val'>&#39;label&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span> <span class='integer val'>? </span><span class='string val'>&#39;&#39;</span> <span class='colon op'>:</span> <span class='dstring node'>&quot;#{date[&#39;label&#39;].titlecase}: &quot;</span>
    <span class='rubyid_label identifier id'>label</span> <span class='assign token'>=</span> <span class='string val'>&#39;&#39;</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_label identifier id'>label</span> <span class='eq op'>==</span> <span class='string val'>&#39;Creation: &#39;</span>
    <span class='rubyid_exp identifier id'>exp</span> <span class='assign token'>=</span>  <span class='rubyid_date identifier id'>date</span><span class='lbrack token'>[</span><span class='string val'>&#39;expression&#39;</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='string val'>&#39;&#39;</span>
    <span class='rubyid_if if kw'>if</span> <span class='rubyid_exp identifier id'>exp</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span>
      <span class='rubyid_exp identifier id'>exp</span> <span class='assign token'>=</span> <span class='rubyid_date identifier id'>date</span><span class='lbrack token'>[</span><span class='string val'>&#39;begin&#39;</span><span class='rbrack token'>]</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_date identifier id'>date</span><span class='lbrack token'>[</span><span class='string val'>&#39;begin&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span>
      <span class='rubyid_unless unless kw'>unless</span> <span class='rubyid_date identifier id'>date</span><span class='lbrack token'>[</span><span class='string val'>&#39;end&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span>
        <span class='rubyid_exp identifier id'>exp</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='rubyid_exp identifier id'>exp</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span> <span class='integer val'>? </span><span class='string val'>&#39;&#39;</span> <span class='colon op'>:</span> <span class='rubyid_exp identifier id'>exp</span> <span class='plus op'>+</span> <span class='string val'>&#39;-&#39;</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='rubyid_date identifier id'>date</span><span class='lbrack token'>[</span><span class='string val'>&#39;end&#39;</span><span class='rbrack token'>]</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_if if kw'>if</span> <span class='rubyid_date identifier id'>date</span><span class='lbrack token'>[</span><span class='string val'>&#39;date_type&#39;</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='string val'>&#39;bulk&#39;</span>
      <span class='rubyid_exp identifier id'>exp</span> <span class='assign token'>=</span> <span class='rubyid_exp identifier id'>exp</span><span class='dot token'>.</span><span class='rubyid_sub identifier id'>sub</span><span class='lparen token'>(</span><span class='string val'>&#39;bulk&#39;</span><span class='comma token'>,</span><span class='string val'>&#39;&#39;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_sub identifier id'>sub</span><span class='lparen token'>(</span><span class='string val'>&#39;()&#39;</span><span class='comma token'>,</span> <span class='string val'>&#39;&#39;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_strip identifier id'>strip</span>
      <span class='rubyid_exp identifier id'>exp</span> <span class='assign token'>=</span> <span class='rubyid_date identifier id'>date</span><span class='lbrack token'>[</span><span class='string val'>&#39;begin&#39;</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='rubyid_date identifier id'>date</span><span class='lbrack token'>[</span><span class='string val'>&#39;end&#39;</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='rubyid_I18n constant id'>I18n</span><span class='dot token'>.</span><span class='rubyid_t identifier id'>t</span><span class='lparen token'>(</span><span class='string val'>&#39;bulk._singular&#39;</span><span class='comma token'>,</span> <span class='symbol val'>:dates</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_exp identifier id'>exp</span><span class='rparen token'>)</span> <span class='colon op'>:</span>
        <span class='rubyid_I18n constant id'>I18n</span><span class='dot token'>.</span><span class='rubyid_t identifier id'>t</span><span class='lparen token'>(</span><span class='string val'>&#39;bulk._plural&#39;</span><span class='comma token'>,</span> <span class='symbol val'>:dates</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_exp identifier id'>exp</span><span class='rparen token'>)</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&#39;html&#39;</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>&#39;dates&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='string val'>&#39;final_expression&#39;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_label identifier id'>label</span> <span class='plus op'>+</span> <span class='rubyid_exp identifier id'>exp</span><span class='comma token'>,</span> <span class='string val'>&#39;_inherited&#39;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_date identifier id'>date</span><span class='dot token'>.</span><span class='rubyid_dig identifier id'>dig</span><span class='lparen token'>(</span><span class='string val'>&#39;_inherited&#39;</span><span class='rparen token'>)</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="handle_external_docs-instance_method">
  
    #<strong>handle_external_docs</strong>(json)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


49
50
51
52
53
54
55
56
57
58
59
60
61
62</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'public/app/controllers/concerns/result_info.rb', line 49</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_handle_external_docs identifier id'>handle_external_docs</span><span class='lparen token'>(</span><span class='rubyid_json identifier id'>json</span><span class='rparen token'>)</span>
  <span class='rubyid_unless unless kw'>unless</span> <span class='notop op'>!</span><span class='rubyid_json identifier id'>json</span><span class='dot token'>.</span><span class='rubyid_has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='string val'>&#39;external_documents&#39;</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&#39;external_documents&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span>
    <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&#39;html&#39;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span> <span class='rubyid_if if_mod kw'>if</span> <span class='notop op'>!</span><span class='rubyid_json identifier id'>json</span><span class='dot token'>.</span><span class='rubyid_dig identifier id'>dig</span><span class='lparen token'>(</span><span class='string val'>&#39;html&#39;</span><span class='rparen token'>)</span>
    <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&#39;html&#39;</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>&#39;external_documents&#39;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&#39;external_documents&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_doc identifier id'>doc</span><span class='bitor op'>|</span>
      <span class='rubyid_if if kw'>if</span> <span class='rubyid_doc identifier id'>doc</span><span class='lbrack token'>[</span><span class='string val'>&#39;publish&#39;</span><span class='rbrack token'>]</span>
        <span class='rubyid_extd identifier id'>extd</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
        <span class='rubyid_extd identifier id'>extd</span><span class='lbrack token'>[</span><span class='string val'>&#39;title&#39;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_doc identifier id'>doc</span><span class='lbrack token'>[</span><span class='string val'>&#39;title&#39;</span><span class='rbrack token'>]</span>
        <span class='rubyid_extd identifier id'>extd</span><span class='lbrack token'>[</span><span class='string val'>&#39;uri&#39;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_doc identifier id'>doc</span><span class='lbrack token'>[</span><span class='string val'>&#39;location&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_start_with? fid id'>start_with?</span><span class='lparen token'>(</span><span class='string val'>&#39;http&#39;</span><span class='rparen token'>)</span> <span class='question op'>?</span> <span class='rubyid_doc identifier id'>doc</span><span class='lbrack token'>[</span><span class='string val'>&#39;location&#39;</span><span class='rbrack token'>]</span> <span class='colon op'>:</span>  <span class='string val'>&#39;&#39;</span>
        <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&#39;html&#39;</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>&#39;external_documents&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='rubyid_extd identifier id'>extd</span><span class='rparen token'>)</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="process_agents-instance_method">
  
    #<strong>process_agents</strong>(agents_arr, subjects_arr = [])  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>create a usable agent hash</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


90
91
92
93
94
95
96
97
98
99
100
101
102
103
104</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'public/app/controllers/concerns/result_info.rb', line 90</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_process_agents identifier id'>process_agents</span><span class='lparen token'>(</span><span class='rubyid_agents_arr identifier id'>agents_arr</span><span class='comma token'>,</span> <span class='rubyid_subjects_arr identifier id'>subjects_arr</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='rubyid_agents_h identifier id'>agents_h</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='rubyid_agents_arr identifier id'>agents_arr</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_agent identifier id'>agent</span><span class='bitor op'>|</span>
    <span class='rubyid_unless unless kw'>unless</span> <span class='rubyid_agent identifier id'>agent</span><span class='lbrack token'>[</span><span class='string val'>&#39;role&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span> <span class='orop op'>||</span> <span class='rubyid_agent identifier id'>agent</span><span class='lbrack token'>[</span><span class='string val'>&#39;_resolved&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span>
      <span class='rubyid_role identifier id'>role</span> <span class='assign token'>=</span> <span class='rubyid_agent identifier id'>agent</span><span class='lbrack token'>[</span><span class='string val'>&#39;role&#39;</span><span class='rbrack token'>]</span>
      <span class='rubyid_if if kw'>if</span> <span class='rubyid_role identifier id'>role</span> <span class='eq op'>==</span> <span class='string val'>&#39;subject&#39;</span>
        <span class='rubyid_subjects_arr identifier id'>subjects_arr</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='rubyid_agent identifier id'>agent</span><span class='lbrack token'>[</span><span class='string val'>&#39;_resolved&#39;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
      <span class='rubyid_elsif elsif kw'>elsif</span> <span class='rubyid_ag identifier id'>ag</span>
        <span class='rubyid_agents_h identifier id'>agents_h</span><span class='lbrack token'>[</span><span class='rubyid_role identifier id'>role</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_agents_h identifier id'>agents_h</span><span class='lbrack token'>[</span><span class='rubyid_role identifier id'>role</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span> <span class='integer val'>? </span><span class='lbrack token'>[</span><span class='rubyid_ag identifier id'>ag</span><span class='rbrack token'>]</span> <span class='colon op'>:</span> <span class='rubyid_agents_h identifier id'>agents_h</span><span class='lbrack token'>[</span><span class='rubyid_role identifier id'>role</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='rubyid_ag identifier id'>ag</span><span class='rparen token'>)</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_subjects_arr identifier id'>subjects_arr</span><span class='dot token'>.</span><span class='rubyid_sort_by! fid id'>sort_by!</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_hsh identifier id'>hsh</span><span class='bitor op'>|</span> <span class='rubyid_hsh identifier id'>hsh</span><span class='lbrack token'>[</span><span class='string val'>&#39;title&#39;</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span>
  <span class='rubyid_agents_h identifier id'>agents_h</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="process_digital-instance_method">
  
    #<strong>process_digital</strong>(json)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>digital object processing</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


107
108
109
110
111
112
113
114
115
116
117
118</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'public/app/controllers/concerns/result_info.rb', line 107</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_process_digital identifier id'>process_digital</span><span class='lparen token'>(</span><span class='rubyid_json identifier id'>json</span><span class='rparen token'>)</span>
  <span class='rubyid_dig_obj identifier id'>dig_obj</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='rubyid_unless unless kw'>unless</span> <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&#39;digital_object_id&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span> <span class='orop op'>||</span>  <span class='notop op'>!</span><span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&#39;digital_object_id&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_start_with? fid id'>start_with?</span><span class='lparen token'>(</span><span class='string val'>&#39;http&#39;</span><span class='rparen token'>)</span>
    <span class='rubyid_dig_obj identifier id'>dig_obj</span><span class='lbrack token'>[</span><span class='string val'>&#39;out&#39;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&#39;digital_object_id&#39;</span><span class='rbrack token'>]</span>
  <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_dig_obj identifier id'>dig_obj</span> <span class='assign token'>=</span> <span class='rubyid_process_file_versions identifier id'>process_file_versions</span><span class='lparen token'>(</span><span class='rubyid_json identifier id'>json</span><span class='rparen token'>)</span>
  <span class='rubyid_unless unless kw'>unless</span> <span class='rubyid_dig_obj identifier id'>dig_obj</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span>
    <span class='rubyid_dig_obj identifier id'>dig_obj</span><span class='lbrack token'>[</span><span class='string val'>&#39;material&#39;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&#39;digital_object_type&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span> <span class='integer val'>? </span><span class='string val'>&#39;&#39;</span> <span class='colon op'>:</span> <span class='string val'>&#39;(&#39;</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&#39;digital_object_type&#39;</span><span class='rbrack token'>]</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>&#39;)&#39;</span>
    <span class='rubyid_dig_obj identifier id'>dig_obj</span><span class='lbrack token'>[</span><span class='string val'>&#39;caption&#39;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='rubyid_escapeHTML identifier id'>escapeHTML</span><span class='lparen token'>(</span><span class='rubyid_strip_mixed_content identifier id'>strip_mixed_content</span><span class='lparen token'>(</span><span class='rubyid_json identifier id'>json</span><span class='dot token'>.</span><span class='rubyid_fetch identifier id'>fetch</span><span class='lparen token'>(</span><span class='string val'>&#39;display_string&#39;</span><span class='comma token'>,</span> <span class='string val'>&#39;Untitled&#39;</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_dig_obj identifier id'>dig_obj</span><span class='lbrack token'>[</span><span class='string val'>&#39;caption&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='rubyid_dig_obj identifier id'>dig_obj</span><span class='lbrack token'>[</span><span class='string val'>&#39;thumb&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span>
  <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_dig_obj identifier id'>dig_obj</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span> <span class='integer val'>? </span><span class='lbrack token'>[</span><span class='rbrack token'>]</span> <span class='colon op'>:</span> <span class='lbrack token'>[</span><span class='rubyid_dig_obj identifier id'>dig_obj</span><span class='rbrack token'>]</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="process_digital_instance-instance_method">
  
    #<strong>process_digital_instance</strong>(instances)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>representative digital object for an archival object</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'public/app/controllers/concerns/result_info.rb', line 141</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_process_digital_instance identifier id'>process_digital_instance</span><span class='lparen token'>(</span><span class='rubyid_instances identifier id'>instances</span><span class='rparen token'>)</span>
  <span class='rubyid_dig_objs identifier id'>dig_objs</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='rubyid_if if kw'>if</span> <span class='rubyid_instances identifier id'>instances</span> <span class='andop op'>&amp;&amp;</span> <span class='rubyid_instances identifier id'>instances</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_Array constant id'>Array</span><span class='rparen token'>)</span>
    <span class='rubyid_instances identifier id'>instances</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_instance identifier id'>instance</span><span class='bitor op'>|</span>
      <span class='rubyid_unless unless kw'>unless</span> <span class='notop op'>!</span><span class='rubyid_instance identifier id'>instance</span><span class='dot token'>.</span><span class='rubyid_dig identifier id'>dig</span><span class='lparen token'>(</span><span class='string val'>&#39;digital_object&#39;</span><span class='comma token'>,</span><span class='string val'>&#39;_resolved&#39;</span><span class='rparen token'>)</span>
        <span class='rubyid_dig_f identifier id'>dig_f</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
        <span class='rubyid_it identifier id'>it</span> <span class='assign token'>=</span>  <span class='rubyid_instance identifier id'>instance</span><span class='lbrack token'>[</span><span class='string val'>&#39;digital_object&#39;</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>&#39;_resolved&#39;</span><span class='rbrack token'>]</span>
         <span class='rubyid_unless unless kw'>unless</span> <span class='rubyid_it identifier id'>it</span><span class='lbrack token'>[</span><span class='string val'>&#39;file_versions&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span>
           <span class='rubyid_title identifier id'>title</span> <span class='assign token'>=</span> <span class='rubyid_strip_mixed_content identifier id'>strip_mixed_content</span><span class='lparen token'>(</span><span class='rubyid_it identifier id'>it</span><span class='lbrack token'>[</span><span class='string val'>&#39;title&#39;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
           <span class='rubyid_dig_f identifier id'>dig_f</span> <span class='assign token'>=</span> <span class='rubyid_process_file_versions identifier id'>process_file_versions</span><span class='lparen token'>(</span><span class='rubyid_it identifier id'>it</span><span class='rparen token'>)</span>
           <span class='rubyid_dig_f identifier id'>dig_f</span><span class='lbrack token'>[</span><span class='string val'>&#39;caption&#39;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='rubyid_escapeHTML identifier id'>escapeHTML</span><span class='lparen token'>(</span><span class='rubyid_title identifier id'>title</span><span class='rparen token'>)</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_dig_f identifier id'>dig_f</span><span class='lbrack token'>[</span><span class='string val'>&#39;caption&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='rubyid_title identifier id'>title</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span>
         <span class='rubyid_end end kw'>end</span>
        <span class='rubyid_dig_f identifier id'>dig_f</span><span class='lbrack token'>[</span><span class='string val'>&#39;material&#39;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_it identifier id'>it</span><span class='lbrack token'>[</span><span class='string val'>&#39;digital_object_type&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span> <span class='integer val'>? </span><span class='string val'>&#39;&#39;</span> <span class='colon op'>:</span> <span class='string val'>&#39;(&#39;</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_it identifier id'>it</span><span class='lbrack token'>[</span><span class='string val'>&#39;digital_object_type&#39;</span><span class='rbrack token'>]</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>&#39;)&#39;</span>
      <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_dig_objs identifier id'>dig_objs</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='rubyid_dig_f identifier id'>dig_f</span><span class='rparen token'>)</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_dig_f identifier id'>dig_f</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_dig_objs identifier id'>dig_objs</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="process_extents-instance_method">
  
    #<strong>process_extents</strong>(json)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>process extents for display; format per Mark Custer</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'public/app/controllers/concerns/result_info.rb', line 122</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_process_extents identifier id'>process_extents</span><span class='lparen token'>(</span><span class='rubyid_json identifier id'>json</span><span class='rparen token'>)</span>
  <span class='rubyid_unless unless kw'>unless</span>  <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&#39;extents&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span>
    <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&#39;html&#39;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span> <span class='rubyid_if if_mod kw'>if</span> <span class='notop op'>!</span><span class='rubyid_json identifier id'>json</span><span class='dot token'>.</span><span class='rubyid_dig identifier id'>dig</span><span class='lparen token'>(</span><span class='string val'>&#39;html&#39;</span><span class='rparen token'>)</span>
    <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&#39;html&#39;</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>&#39;extents&#39;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&#39;extents&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_ext identifier id'>ext</span><span class='bitor op'>|</span>
      <span class='rubyid_display identifier id'>display</span> <span class='assign token'>=</span> <span class='string val'>&#39;&#39;</span>
      <span class='rubyid_type identifier id'>type</span> <span class='assign token'>=</span> <span class='rubyid_I18n constant id'>I18n</span><span class='dot token'>.</span><span class='rubyid_t identifier id'>t</span><span class='lparen token'>(</span><span class='dstring node'>&quot;enumerations.extent_extent_type.#{ext[&#39;extent_type&#39;]}&quot;</span><span class='comma token'>,</span> <span class='label val'>default:</span> <span class='rubyid_ext identifier id'>ext</span><span class='lbrack token'>[</span><span class='string val'>&#39;extent_type&#39;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
      <span class='rubyid_display identifier id'>display</span> <span class='assign token'>=</span> <span class='rubyid_I18n constant id'>I18n</span><span class='dot token'>.</span><span class='rubyid_t identifier id'>t</span><span class='lparen token'>(</span><span class='string val'>&#39;extent_number_type&#39;</span><span class='comma token'>,</span> <span class='symbol val'>:number</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_ext identifier id'>ext</span><span class='lbrack token'>[</span><span class='string val'>&#39;number&#39;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='symbol val'>:type</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_type identifier id'>type</span><span class='rparen token'>)</span>
      <span class='rubyid_summ identifier id'>summ</span> <span class='assign token'>=</span> <span class='rubyid_ext identifier id'>ext</span><span class='lbrack token'>[</span><span class='string val'>&#39;container_summary&#39;</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='string val'>&#39;&#39;</span>
      <span class='rubyid_summ identifier id'>summ</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;(#{summ})&quot;</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_summ identifier id'>summ</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span> <span class='orop op'>||</span> <span class='lparen token'>(</span> <span class='rubyid_summ identifier id'>summ</span><span class='dot token'>.</span><span class='rubyid_start_with? fid id'>start_with?</span><span class='lparen token'>(</span><span class='string val'>&#39;(&#39;</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='rubyid_summ identifier id'>summ</span><span class='dot token'>.</span><span class='rubyid_end_with? fid id'>end_with?</span><span class='lparen token'>(</span><span class='string val'>&#39;)&#39;</span><span class='rparen token'>)</span><span class='rparen token'>)</span>  <span class='comment val'># yeah, I coulda done this with rexep.</span>
      <span class='rubyid_display identifier id'>display</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>&#39; &#39;</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_summ identifier id'>summ</span>
      <span class='rubyid_display identifier id'>display</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_I18n constant id'>I18n</span><span class='dot token'>.</span><span class='rubyid_t identifier id'>t</span><span class='lparen token'>(</span><span class='string val'>&#39;extent_phys_details&#39;</span><span class='comma token'>,</span><span class='symbol val'>:deets</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_ext identifier id'>ext</span><span class='lbrack token'>[</span><span class='string val'>&#39;physical_details&#39;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='rubyid_unless unless_mod kw'>unless</span>  <span class='rubyid_ext identifier id'>ext</span><span class='lbrack token'>[</span><span class='string val'>&#39;physical_details&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span>
      <span class='rubyid_display identifier id'>display</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_I18n constant id'>I18n</span><span class='dot token'>.</span><span class='rubyid_t identifier id'>t</span><span class='lparen token'>(</span><span class='string val'>&#39;extent_dims&#39;</span><span class='comma token'>,</span> <span class='symbol val'>:dimensions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_ext identifier id'>ext</span><span class='lbrack token'>[</span><span class='string val'>&#39;dimensions&#39;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='rubyid_unless unless_mod kw'>unless</span>  <span class='rubyid_ext identifier id'>ext</span><span class='lbrack token'>[</span><span class='string val'>&#39;dimensions&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span>
      <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&#39;html&#39;</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>&#39;extents&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='string val'>&#39;display&#39;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_display identifier id'>display</span><span class='comma token'>,</span> <span class='string val'>&#39;_inherited&#39;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_ext identifier id'>ext</span><span class='dot token'>.</span><span class='rubyid_dig identifier id'>dig</span><span class='lparen token'>(</span><span class='string val'>&#39;_inherited&#39;</span><span class='rparen token'>)</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="process_file_versions-instance_method">
  
    #<strong>process_file_versions</strong>(json)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>get links (including thumbnail, caption) for <em>one</em> digital object</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'public/app/controllers/concerns/result_info.rb', line 162</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_process_file_versions identifier id'>process_file_versions</span><span class='lparen token'>(</span><span class='rubyid_json identifier id'>json</span><span class='rparen token'>)</span>
  <span class='rubyid_dig_f identifier id'>dig_f</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='rubyid_unless unless kw'>unless</span> <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&#39;file_versions&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span>
    <span class='rubyid_embed_caption identifier id'>embed_caption</span> <span class='assign token'>=</span> <span class='string val'>&#39;&#39;</span>
    <span class='rubyid_rep_caption identifier id'>rep_caption</span> <span class='assign token'>=</span> <span class='string val'>&#39;&#39;</span>
    <span class='rubyid_json identifier id'>json</span><span class='lbrack token'>[</span><span class='string val'>&#39;file_versions&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_version identifier id'>version</span><span class='bitor op'>|</span>
      <span class='rubyid_version identifier id'>version</span><span class='lbrack token'>[</span><span class='string val'>&#39;file_uri&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_strip! fid id'>strip!</span>
      <span class='rubyid_if if kw'>if</span> <span class='rubyid_version identifier id'>version</span><span class='dot token'>.</span><span class='rubyid_dig identifier id'>dig</span><span class='lparen token'>(</span><span class='string val'>&#39;publish&#39;</span><span class='rparen token'>)</span> <span class='neq op'>!=</span> <span class='rubyid_false false kw'>false</span> <span class='andop op'>&amp;&amp;</span> <span class='rubyid_version identifier id'>version</span><span class='lbrack token'>[</span><span class='string val'>&#39;file_uri&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_start_with? fid id'>start_with?</span><span class='lparen token'>(</span><span class='string val'>&#39;http&#39;</span><span class='rparen token'>)</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_version identifier id'>version</span><span class='dot token'>.</span><span class='rubyid_dig identifier id'>dig</span><span class='lparen token'>(</span><span class='string val'>&#39;xlink_show_attribute&#39;</span><span class='rparen token'>)</span> <span class='eq op'>==</span> <span class='string val'>&#39;embed&#39;</span>
          <span class='rubyid_dig_f identifier id'>dig_f</span><span class='lbrack token'>[</span><span class='string val'>&#39;thumb&#39;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_version identifier id'>version</span><span class='lbrack token'>[</span><span class='string val'>&#39;file_uri&#39;</span><span class='rbrack token'>]</span>
          <span class='rubyid_dig_f identifier id'>dig_f</span><span class='lbrack token'>[</span><span class='string val'>&#39;represent&#39;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>&#39;embed&#39;</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_version identifier id'>version</span><span class='lbrack token'>[</span><span class='string val'>&#39;is_representative&#39;</span><span class='rbrack token'>]</span>
          <span class='comment val'># For an embedded file version, if the caption is empty,</span>
          <span class='comment val'># 1. set the embed_caption to the title</span>
          <span class='comment val'># 2. set the rep_caption to the title if it is a representative version</span>
          <span class='rubyid_if if kw'>if</span> <span class='rubyid_version identifier id'>version</span><span class='lbrack token'>[</span><span class='string val'>&#39;caption&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span>
            <span class='rubyid_embed_caption identifier id'>embed_caption</span> <span class='assign token'>=</span> <span class='rubyid_version identifier id'>version</span><span class='lbrack token'>[</span><span class='string val'>&#39;title&#39;</span><span class='rbrack token'>]</span>
            <span class='rubyid_rep_caption identifier id'>rep_caption</span> <span class='assign token'>=</span> <span class='rubyid_version identifier id'>version</span><span class='lbrack token'>[</span><span class='string val'>&#39;title&#39;</span><span class='rbrack token'>]</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_version identifier id'>version</span><span class='lbrack token'>[</span><span class='string val'>&#39;is_representative&#39;</span><span class='rbrack token'>]</span>
          <span class='rubyid_else else kw'>else</span>
            <span class='comment val'># For an embedded file version, if the caption is not empty,</span>
            <span class='comment val'># 1. set the embed_caption to the caption</span>
            <span class='comment val'># 2. set the rep_caption to the caption if it is a representative version</span>
            <span class='rubyid_embed_caption identifier id'>embed_caption</span> <span class='assign token'>=</span> <span class='rubyid_version identifier id'>version</span><span class='lbrack token'>[</span><span class='string val'>&#39;caption&#39;</span><span class='rbrack token'>]</span>
            <span class='rubyid_rep_caption identifier id'>rep_caption</span> <span class='assign token'>=</span> <span class='rubyid_version identifier id'>version</span><span class='lbrack token'>[</span><span class='string val'>&#39;caption&#39;</span><span class='rbrack token'>]</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_version identifier id'>version</span><span class='lbrack token'>[</span><span class='string val'>&#39;is_representative&#39;</span><span class='rbrack token'>]</span>
          <span class='rubyid_end end kw'>end</span>
        <span class='rubyid_else else kw'>else</span>
          <span class='rubyid_dig_f identifier id'>dig_f</span><span class='lbrack token'>[</span><span class='string val'>&#39;represent&#39;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>&#39;new&#39;</span>  <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_version identifier id'>version</span><span class='lbrack token'>[</span><span class='string val'>&#39;is_representative&#39;</span><span class='rbrack token'>]</span>
          <span class='rubyid_dig_f identifier id'>dig_f</span><span class='lbrack token'>[</span><span class='string val'>&#39;out&#39;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_version identifier id'>version</span><span class='lbrack token'>[</span><span class='string val'>&#39;file_uri&#39;</span><span class='rbrack token'>]</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_version identifier id'>version</span><span class='lbrack token'>[</span><span class='string val'>&#39;file_uri&#39;</span><span class='rbrack token'>]</span> <span class='neq op'>!=</span> <span class='lparen token'>(</span><span class='rubyid_dig_f identifier id'>dig_f</span><span class='lbrack token'>[</span><span class='string val'>&#39;out&#39;</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='string val'>&#39;&#39;</span><span class='rparen token'>)</span>
          <span class='comment val'># if the caption is empty set the rep_caption to the title</span>
          <span class='rubyid_if if kw'>if</span> <span class='rubyid_version identifier id'>version</span><span class='lbrack token'>[</span><span class='string val'>&#39;caption&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span>
            <span class='rubyid_rep_caption identifier id'>rep_caption</span> <span class='assign token'>=</span> <span class='rubyid_version identifier id'>version</span><span class='lbrack token'>[</span><span class='string val'>&#39;title&#39;</span><span class='rbrack token'>]</span>
          <span class='rubyid_else else kw'>else</span>
            <span class='comment val'># if the caption is not empty set the rep_caption to the caption</span>
            <span class='rubyid_rep_caption identifier id'>rep_caption</span> <span class='assign token'>=</span> <span class='rubyid_version identifier id'>version</span><span class='lbrack token'>[</span><span class='string val'>&#39;caption&#39;</span><span class='rbrack token'>]</span>
          <span class='rubyid_end end kw'>end</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_elsif elsif kw'>elsif</span> <span class='notop op'>!</span><span class='rubyid_version identifier id'>version</span><span class='lbrack token'>[</span><span class='string val'>&#39;file_uri&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_start_with? fid id'>start_with?</span><span class='lparen token'>(</span><span class='string val'>&#39;http&#39;</span><span class='rparen token'>)</span>
        <span class='rubyid_Rails constant id'>Rails</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_debug identifier id'>debug</span><span class='lparen token'>(</span><span class='dstring node'>&quot;****BAD URI? #{version[&#39;file_uri&#39;]}&quot;</span><span class='rparen token'>)</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
  <span class='comment val'># Use the representative caption for the caption in the PUI if there is a</span>
  <span class='comment val'># representative caption</span>
  <span class='rubyid_if if kw'>if</span> <span class='notop op'>!</span><span class='rubyid_rep_caption identifier id'>rep_caption</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span>
    <span class='rubyid_dig_f identifier id'>dig_f</span><span class='lbrack token'>[</span><span class='string val'>&#39;caption&#39;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_rep_caption identifier id'>rep_caption</span>
  <span class='rubyid_elsif elsif kw'>elsif</span> <span class='notop op'>!</span><span class='rubyid_embed_caption identifier id'>embed_caption</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span>
    <span class='comment val'># Use the embed caption for the caption in the PUI if there is isn&#39;t a</span>
    <span class='comment val'># representative caption but there is an embedded caption</span>
    <span class='rubyid_dig_f identifier id'>dig_f</span><span class='lbrack token'>[</span><span class='string val'>&#39;caption&#39;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_rep_caption identifier id'>rep_caption</span>
  <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_dig_f identifier id'>dig_f</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="process_repo_info-instance_method">
  
    #<strong>process_repo_info</strong>(repo)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>extract the repository agent info</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'public/app/controllers/concerns/result_info.rb', line 65</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_process_repo_info identifier id'>process_repo_info</span><span class='lparen token'>(</span><span class='rubyid_repo identifier id'>repo</span><span class='rparen token'>)</span>
  <span class='rubyid_info identifier id'>info</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='rubyid_info identifier id'>info</span><span class='lbrack token'>[</span><span class='string val'>&#39;top&#39;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='rubyid_unless unless kw'>unless</span> <span class='rubyid_repo identifier id'>repo</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
    <span class='dstring node'>%w(name uri url parent_institution_name image_url repo_code description)</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span> <span class='rubyid_item identifier id'>item</span> <span class='bitor op'>|</span>
      <span class='rubyid_info identifier id'>info</span><span class='lbrack token'>[</span><span class='string val'>&#39;top&#39;</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='rubyid_item identifier id'>item</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_repo identifier id'>repo</span><span class='lbrack token'>[</span><span class='rubyid_item identifier id'>item</span><span class='rbrack token'>]</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_repo identifier id'>repo</span><span class='lbrack token'>[</span><span class='rubyid_item identifier id'>item</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_unless unless kw'>unless</span> <span class='rubyid_repo identifier id'>repo</span><span class='lbrack token'>[</span><span class='string val'>&#39;agent_representation&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span> <span class='orop op'>||</span> <span class='rubyid_repo identifier id'>repo</span><span class='lbrack token'>[</span><span class='string val'>&#39;agent_representation&#39;</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>&#39;_resolved&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span> <span class='orop op'>||</span> <span class='rubyid_repo identifier id'>repo</span><span class='lbrack token'>[</span><span class='string val'>&#39;agent_representation&#39;</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>&#39;_resolved&#39;</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>&#39;jsonmodel_type&#39;</span><span class='rbrack token'>]</span> <span class='neq op'>!=</span> <span class='string val'>&#39;agent_corporate_entity&#39;</span>
      <span class='rubyid_in_h identifier id'>in_h</span> <span class='assign token'>=</span> <span class='rubyid_repo identifier id'>repo</span><span class='lbrack token'>[</span><span class='string val'>&#39;agent_representation&#39;</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>&#39;_resolved&#39;</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>&#39;agent_contacts&#39;</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span>
      <span class='dstring node'>%w{city region post_code country email }</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_k identifier id'>k</span><span class='bitor op'>|</span>
        <span class='rubyid_info identifier id'>info</span><span class='lbrack token'>[</span><span class='rubyid_k identifier id'>k</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_in_h identifier id'>in_h</span><span class='lbrack token'>[</span><span class='rubyid_k identifier id'>k</span><span class='rbrack token'>]</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_in_h identifier id'>in_h</span><span class='lbrack token'>[</span><span class='rubyid_k identifier id'>k</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_present? fid id'>present?</span>
      <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_if if kw'>if</span> <span class='rubyid_in_h identifier id'>in_h</span><span class='lbrack token'>[</span><span class='string val'>&#39;address_1&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_present? fid id'>present?</span>
        <span class='rubyid_info identifier id'>info</span><span class='lbrack token'>[</span><span class='string val'>&#39;address&#39;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
        <span class='lbrack token'>[</span><span class='integer val'>1</span><span class='comma token'>,</span><span class='integer val'>2</span><span class='comma token'>,</span><span class='integer val'>3</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_i identifier id'>i</span><span class='bitor op'>|</span>
          <span class='rubyid_info identifier id'>info</span><span class='lbrack token'>[</span><span class='string val'>&#39;address&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='rubyid_in_h identifier id'>in_h</span><span class='lbrack token'>[</span><span class='dstring node'>&quot;address_#{i}&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_in_h identifier id'>in_h</span><span class='lbrack token'>[</span><span class='dstring node'>&quot;address_#{i}&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_present? fid id'>present?</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_info identifier id'>info</span><span class='lbrack token'>[</span><span class='string val'>&#39;telephones&#39;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_in_h identifier id'>in_h</span><span class='lbrack token'>[</span><span class='string val'>&#39;telephones&#39;</span><span class='rbrack token'>]</span> <span class='rubyid_if if_mod kw'>if</span> <span class='notop op'>!</span><span class='rubyid_in_h identifier id'>in_h</span><span class='lbrack token'>[</span><span class='string val'>&#39;telephones&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_info identifier id'>info</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="process_subjects-instance_method">
  
    #<strong>process_subjects</strong>(subjects_arr)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>create a usable subjects array</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


215
216
217
218
219
220
221
222
223</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'public/app/controllers/concerns/result_info.rb', line 215</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_process_subjects identifier id'>process_subjects</span><span class='lparen token'>(</span><span class='rubyid_subjects_arr identifier id'>subjects_arr</span><span class='rparen token'>)</span>
  <span class='rubyid_return_arr identifier id'>return_arr</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='rubyid_subjects_arr identifier id'>subjects_arr</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_subject identifier id'>subject</span><span class='bitor op'>|</span>
    <span class='rubyid_unless unless kw'>unless</span> <span class='rubyid_subject identifier id'>subject</span><span class='lbrack token'>[</span><span class='string val'>&#39;_resolved&#39;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_blank? fid id'>blank?</span>
      <span class='rubyid_return_arr identifier id'>return_arr</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='rubyid_subject identifier id'>subject</span><span class='lbrack token'>[</span><span class='string val'>&#39;_resolved&#39;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_return_arr identifier id'>return_arr</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  ArchivesSpace Version v2.8.0.a Documentation Generated on Thu Jul 16 10:06:59 2020 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.20.
</div>

    </div>
  </body>
</html>